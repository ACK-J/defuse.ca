<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>/var/www/devel/ossbox/trunk/src/pages/services/trustedthirdparty.php.html</title>
<meta name="Generator" content="Vim/7.3">
<meta name="plugin-version" content="vim7.3_v6">
<meta name="syntax" content="php">
<meta name="settings" content="use_css,number_lines">
<style type="text/css">
<!--
pre { font-family: monospace; color: #c0c0c0; background-color: #000000; }
body { font-family: monospace; color: #c0c0c0; background-color: #000000; }
.lnr { color: #008888; background-color: #000000; }
.htmlItalic { font-style: italic; }
.htmlUnderline { text-decoration: underline; }
.htmlBoldUnderline { font-weight: bold; text-decoration: underline; }
.Constant { color: #00ffff; }
.Underlined { color: #80a0ff; text-decoration: underline; }
.Title { color: #00ffff; }
.PreProc { color: #ffffff; }
.htmlBold { font-weight: bold; }
.Type { color: #ffffff; }
.Statement { color: #00ffff; font-weight: bold; }
.Function { color: #00ffff; background-color: #000000; }
.Identifier { color: #00cccc; background-color: #000000; }
.Operator { color: #696969; }
.String { color: #00bbbb; }
.Comment { color: #696969; }
.Special { color: #ffffff; background-color: #000000; }
-->
</style>
</head>
<body>
<pre>
<span class="lnr">  1 </span><span class="Special">&lt;?php</span>
<span class="lnr">  2 </span><span class="Comment">/*</span>
<span class="lnr">  3 </span><span class="Comment"> * This file is Copyright (C) 2011 Defuse.ca</span>
<span class="lnr">  4 </span><span class="Comment"> * This code is provided for peer review purposes only.</span>
<span class="lnr">  5 </span><span class="Comment"> * It may not be distributed, copied, or altered in any way.</span>
<span class="lnr">  6 </span><span class="Comment"> *</span>
<span class="lnr">  7 </span><span class="Comment"> * Sorry, I just don't want backdoored RNG services that look like TRENT to be created.</span>
<span class="lnr">  8 </span><span class="Comment"> * Thanks for your understanding.</span>
<span class="lnr">  9 </span><span class="Comment">*/</span>
<span class="lnr"> 10 </span>
<span class="lnr"> 11 </span><span class="Comment">// Set the default date to UTC so TRENT is usable from different time zones.</span>
<span class="lnr"> 12 </span>date_default_timezone_set<span class="Special">(</span>&quot;<span class="String">UTC</span>&quot;<span class="Special">)</span>;
<span class="lnr"> 13 </span>
<span class="lnr"> 14 </span><span class="Operator">$</span><span class="Identifier">dbhost</span> <span class="Operator">=</span> '<span class="String">localhost</span>';
<span class="lnr"> 15 </span><span class="Operator">$</span><span class="Identifier">dbuser</span> <span class="Operator">=</span> '';
<span class="lnr"> 16 </span><span class="Operator">$</span><span class="Identifier">dbpass</span> <span class="Operator">=</span> '';
<span class="lnr"> 17 </span>
<span class="lnr"> 18 </span><span class="Operator">$</span><span class="Identifier">conn</span> <span class="Operator">=</span> <span class="Function">mysql_connect</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">dbhost</span>, <span class="Operator">$</span><span class="Identifier">dbuser</span>, <span class="Operator">$</span><span class="Identifier">dbpass</span><span class="Special">)</span> <span class="Operator">or</span> <span class="Statement">die</span> <span class="Special">(</span>'<span class="String">Error connecting to mysql</span>'<span class="Special">)</span>;
<span class="lnr"> 19 </span>
<span class="lnr"> 20 </span><span class="Operator">$</span><span class="Identifier">dbname</span> <span class="Operator">=</span> '<span class="String">cracky_trent</span>';
<span class="lnr"> 21 </span><span class="Function">mysql_select_db</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">dbname</span><span class="Special">)</span>;
<span class="lnr"> 22 </span>
<span class="lnr"> 23 </span><span class="Special">?&gt;</span>
<span class="lnr"> 24 </span>
<span class="lnr"> 25 </span><span class="Comment">&lt;!</span><span class="Comment">-- Begin TRENT Header --</span><span class="Comment">&gt;</span>
<span class="lnr"> 26 </span><span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;font-size: 8pt; text-align:center; border-bottom: solid #000000 5px; padding-bottom: 5px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr"> 27 </span><span class="Function">&lt;</span><span class="Statement">img</span><span class="Function"> </span><span class="Type">src</span><span class="Function">=</span><span class="String">&quot;/images/trusted_third_party.png&quot;</span><span class="Function"> </span><span class="Type">alt</span><span class="Function">=</span><span class="String">&quot;TRENT - Trusted Random Entropy Generator&quot;</span><span class="Function"> </span><span class="Type">title</span><span class="Function">=</span><span class="String">&quot;TRENT - Trusted Third Party&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr"> 28 </span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr"> 29 </span><span class="Function">&lt;</span><span class="Statement">strong</span><span class="Function">&gt;</span><span class="htmlBold">The FREE Third Party Random Number Generator</span><span class="Identifier">&lt;/</span><span class="Statement">strong</span><span class="Identifier">&gt;</span>
<span class="lnr"> 30 </span><span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr"> 31 </span><span class="Comment">&lt;!</span><span class="Comment">-- End TRENT Header --</span><span class="Comment">&gt;</span>
<span class="lnr"> 32 </span>
<span class="lnr"> 33 </span><span class="Comment">&lt;!</span><span class="Comment">-- Clock --</span><span class="Comment">&gt;</span>
<span class="lnr"> 34 </span><span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;text-align:right;&quot;</span><span class="Function">&gt;</span>
<span class="lnr"> 35 </span>    <span class="Special">&lt;?php</span>
<span class="lnr"> 36 </span>        <span class="PreProc">echo</span> &quot;<span class="String">&lt;p&gt;Current UTC Time: </span>&quot; <span class="Operator">.</span> <span class="Function">date</span><span class="Special">(</span>&quot;<span class="String">D M j G:i:s T Y</span>&quot;<span class="Special">)</span> <span class="Operator">.</span> &quot;<span class="String">&lt;/p&gt;</span>&quot;;
<span class="lnr"> 37 </span>    <span class="Special">?&gt;</span>
<span class="lnr"> 38 </span><span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr"> 39 </span>
<span class="lnr"> 40 </span><span class="Special">&lt;?php</span>
<span class="lnr"> 41 </span><span class="Comment">// ============ Begin Drawing Status Code ============</span>
<span class="lnr"> 42 </span><span class="Statement">if</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_GET</span><span class="Special">[</span>'<span class="String">drawingnum</span>'<span class="Special">]))</span>
<span class="lnr"> 43 </span><span class="Special">{</span>
<span class="lnr"> 44 </span>    <span class="Operator">$</span><span class="Identifier">num</span> <span class="Operator">=</span> <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">_GET</span><span class="Special">[</span>'<span class="String">drawingnum</span>'<span class="Special">]</span>;
<span class="lnr"> 45 </span>    <span class="Operator">$</span><span class="Identifier">q</span> <span class="Operator">=</span> <span class="Function">mysql_query</span><span class="Special">(</span>&quot;<span class="String">SELECT * FROM drawings WHERE drawingnum='</span><span class="Operator">$</span><span class="Identifier">num</span><span class="String">'</span>&quot;<span class="Special">)</span>;
<span class="lnr"> 46 </span>    <span class="Statement">if</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">q</span> <span class="Operator">&amp;&amp;</span> <span class="Function">mysql_num_rows</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">q</span><span class="Special">))</span>
<span class="lnr"> 47 </span>    <span class="Special">{</span>
<span class="lnr"> 48 </span>        <span class="Operator">$</span><span class="Identifier">ary</span> <span class="Operator">=</span> <span class="Function">mysql_fetch_array</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">q</span><span class="Special">)</span>;
<span class="lnr"> 49 </span>        <span class="Operator">$</span><span class="Identifier">complete</span> <span class="Operator">=</span> <span class="Special">(</span><span class="Operator">$</span><span class="Identifier">ary</span><span class="Special">[</span>'<span class="String">complete</span>'<span class="Special">]</span> <span class="Statement">==</span> '<span class="String">1</span>'<span class="Special">)</span>;
<span class="lnr"> 50 </span>        <span class="Operator">$</span><span class="Identifier">starttime</span> <span class="Operator">=</span> <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">ary</span><span class="Special">[</span>'<span class="String">starttime</span>'<span class="Special">]</span>;
<span class="lnr"> 51 </span>        <span class="Operator">$</span><span class="Identifier">reviewtime</span> <span class="Operator">=</span> <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">ary</span><span class="Special">[</span>'<span class="String">reviewtime</span>'<span class="Special">]</span>;
<span class="lnr"> 52 </span>        <span class="Operator">$</span><span class="Identifier">safeprintout</span> <span class="Operator">=</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">ary</span><span class="Special">[</span>'<span class="String">printout</span>'<span class="Special">]</span>, ENT_QUOTES<span class="Special">)</span>;
<span class="lnr"> 53 </span>        <span class="Operator">$</span><span class="Identifier">safeuserprintout</span> <span class="Operator">=</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">ary</span><span class="Special">[</span>'<span class="String">userprintout</span>'<span class="Special">]</span>, ENT_QUOTES<span class="Special">)</span>;
<span class="lnr"> 54 </span>        <span class="Operator">$</span><span class="Identifier">drawingtime</span> <span class="Operator">=</span> <span class="Operator">$</span><span class="Identifier">reviewtime</span> <span class="Operator">+</span> <span class="Operator">$</span><span class="Identifier">starttime</span>;
<span class="lnr"> 55 </span>        <span class="Operator">$</span><span class="Identifier">drawdate</span> <span class="Operator">=</span> <span class="Function">date</span><span class="Special">(</span>&quot;<span class="String">D M j G:i:s T Y</span>&quot;, <span class="Operator">$</span><span class="Identifier">drawingtime</span><span class="Special">)</span>;
<span class="lnr"> 56 </span>        <span class="Statement">if</span><span class="Special">(</span><span class="Operator">!</span><span class="Operator">$</span><span class="Identifier">complete</span><span class="Special">)</span>
<span class="lnr"> 57 </span>        <span class="Special">{</span>
<span class="lnr"> 58 </span>        <span class="Special">?&gt;</span>
<span class="lnr"> 59 </span>            <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #c9FFd1; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr"> 60 </span>            <span class="Function">&lt;</span><span class="Statement">h3</span><span class="Function"> </span><span class="Type">class</span><span class="Function">=</span><span class="String">&quot;nopaddingatall&quot;</span><span class="Function">&gt;</span><span class="Title">Info for drawing #</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">num</span> <span class="Special">?&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">h3</span><span class="Identifier">&gt;</span>
<span class="lnr"> 61 </span>            <span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>
<span class="lnr"> 62 </span>                The random numbers for this drawing have not yet been chosen. <span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr"> 63 </span>                The organizer of this drawing will be able to run the random number selection after <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">drawdate</span>; <span class="Special">?&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span>.
<span class="lnr"> 64 </span>            <span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr"> 65 </span>
<span class="lnr"> 66 </span>            <span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>
<span class="lnr"> 67 </span>                This time period is enforced to allow drawing organizers to prove to their clients that they are not repeating the drawing over and over until TRENT picks the numbers they want.
<span class="lnr"> 68 </span>                Since you're seeing this message prior to the random number selection, you can be sure that <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">drawing #</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">num</span>; <span class="Special">?&gt;</span><span class="htmlBold"> can not be repeated</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span>.
<span class="lnr"> 69 </span>                Once the random numbers for drawing <span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">num</span>; <span class="Special">?&gt;</span> have been selected, they cannot be changed.
<span class="lnr"> 70 </span>            <span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr"> 71 </span>            <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr"> 72 </span>        <span class="Special">&lt;?</span>
<span class="lnr"> 73 </span>        <span class="Special">}</span>
<span class="lnr"> 74 </span>        <span class="Statement">else</span>
<span class="lnr"> 75 </span>        <span class="Special">{</span>
<span class="lnr"> 76 </span>        <span class="Special">?&gt;</span>
<span class="lnr"> 77 </span>        <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #C9FFD1; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr"> 78 </span>
<span class="lnr"> 79 </span>            <span class="Function">&lt;</span><span class="Statement">h3</span><span class="Function"> </span><span class="Type">class</span><span class="Function">=</span><span class="String">&quot;nopaddingatall&quot;</span><span class="Function">&gt;</span><span class="Title">Description of drawing #</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">num</span>; <span class="Special">?&gt;</span><span class="Title">:</span><span class="Identifier">&lt;/</span><span class="Statement">h3</span><span class="Identifier">&gt;</span>
<span class="lnr"> 80 </span>            <span class="Function">&lt;</span><span class="Statement">textarea</span><span class="Function"> </span><span class="Type">rows</span><span class="Function">=</span><span class="String">&quot;10&quot;</span><span class="Function"> </span><span class="Type">cols</span><span class="Function">=</span><span class="String">&quot;80&quot;</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;width:98%; background-color: white; color:black;&quot;</span><span class="Function"> </span><span class="Type">readonly</span><span class="Function">=</span><span class="String">&quot;readonly&quot;</span><span class="Function"> &gt;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">safeuserprintout</span>; <span class="Special">?&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">textarea</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr"> 81 </span>
<span class="lnr"> 82 </span>            <span class="Function">&lt;</span><span class="Statement">h3</span><span class="Function"> </span><span class="Type">class</span><span class="Function">=</span><span class="String">&quot;nopaddingatall&quot;</span><span class="Function">&gt;</span><span class="Title">Results for drawing #</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">num</span>; <span class="Special">?&gt;</span><span class="Title">:</span><span class="Identifier">&lt;/</span><span class="Statement">h3</span><span class="Identifier">&gt;</span>
<span class="lnr"> 83 </span>            <span class="Function">&lt;</span><span class="Statement">textarea</span><span class="Function"> </span><span class="Type">rows</span><span class="Function">=</span><span class="String">&quot;20&quot;</span><span class="Function"> </span><span class="Type">cols</span><span class="Function">=</span><span class="String">&quot;80&quot;</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;width:98%; background-color: white; color:black;&quot;</span><span class="Function"> </span><span class="Type">readonly</span><span class="Function">=</span><span class="String">&quot;readonly&quot;</span><span class="Function"> &gt;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">safeprintout</span>; <span class="Special">?&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">textarea</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr"> 84 </span>
<span class="lnr"> 85 </span>            <span class="Function">&lt;</span><span class="Statement">h3</span><span class="Function"> </span><span class="Type">class</span><span class="Function">=</span><span class="String">&quot;nopaddingatall&quot;</span><span class="Function">&gt;</span><span class="Title">How do I tell if the drawing was fair?</span><span class="Identifier">&lt;/</span><span class="Statement">h3</span><span class="Identifier">&gt;</span>
<span class="lnr"> 86 </span>            <span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>Verify the following points:<span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr"> 87 </span>            <span class="Function">&lt;</span><span class="Statement">ul</span><span class="Function">&gt;</span>
<span class="lnr"> 88 </span>                <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>Check that the timestamp looks to be on or near the date the drawing was done.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr"> 89 </span>                <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>The drawing organizer published the drawing number before the drawing took place.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr"> 90 </span>                <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>The drawing organizer's description of how to use the random numbers to select the results of the drawing is straight forward and doesn't bias the results. If the process is extremely complicated or you don't understand the steps, this is cause for concern.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr"> 91 </span>                <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>Follow the process of determining the results (e.g. the lottery winner) yourself to determine if the results claimed by the drawing organizer are valid. The drawing organizer should have provided all the steps you need to follow to determine the winner in the &quot;DESCRIPTION&quot; section of the drawing information.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr"> 92 </span>                <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>The range of random numbers makes sense for what they are being used for (e.g. they include everyone, in a lottery scenario).<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr"> 93 </span>                <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>Obtain any related files from the organizer and verify that the <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">SHA256</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span> checksum is <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">exactly identical</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span> using the <span class="Function">&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">href</span><span class="Function">=</span><span class="String">&quot;checksums.htm&quot;</span><span class="Function">&gt;</span><span class="Underlined">checksum calculator</span><span class="Identifier">&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;</span>.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr"> 94 </span>                <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>Make sure the random data is in the <span class="Function">&lt;</span><span class="Statement">strong</span><span class="Function">&gt;</span><span class="htmlBold">second</span><span class="Identifier">&lt;/</span><span class="Statement">strong</span><span class="Identifier">&gt;</span> text area with the title <span class="Special">&amp;quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> &quot;<span class="String">Results for drawing #</span><span class="Operator">$</span><span class="Identifier">num</span>&quot;; <span class="Special">?&gt;</span><span class="Special">&amp;quot;</span>. The drawing organizer has full control over the text in the first text box.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr"> 95 </span>            <span class="Identifier">&lt;/</span><span class="Statement">ul</span><span class="Identifier">&gt;</span>
<span class="lnr"> 96 </span>            <span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>Once you have verified each point, you can be sure that the drawing organizer was not able to influence the random numbers in any way, and you can trust the results. If you are in doubt, feel free to <span class="Function">&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">href</span><span class="Function">=</span><span class="String">&quot;contact.htm&quot;</span><span class="Function">&gt;</span><span class="Underlined">contact Defuse Security</span><span class="Identifier">&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;</span>, we'll be glad to help.<span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr"> 97 </span>        <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr"> 98 </span>        <span class="Special">&lt;?</span>
<span class="lnr"> 99 </span>        <span class="Special">}</span>
<span class="lnr">100 </span>    <span class="Special">}</span>
<span class="lnr">101 </span>    <span class="Statement">else</span>
<span class="lnr">102 </span>    <span class="Special">{</span>
<span class="lnr">103 </span>    <span class="Special">?&gt;</span>
<span class="lnr">104 </span>        <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #FF9F9F; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">105 </span>        <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">Drawing #</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">num</span> <span class="Special">?&gt;</span><span class="htmlBold"> does not exist.</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span>
<span class="lnr">106 </span>        <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">107 </span>    <span class="Special">&lt;?</span>
<span class="lnr">108 </span>    <span class="Special">}</span>
<span class="lnr">109 </span><span class="Special">}</span>
<span class="lnr">110 </span><span class="Comment">// ============ End Drawing Status Code ============</span>
<span class="lnr">111 </span><span class="Special">?&gt;</span>
<span class="lnr">112 </span>
<span class="lnr">113 </span><span class="Function">&lt;</span><span class="Statement">h2</span><span class="Function">&gt;</span><span class="Title">Validate Random Numbers</span><span class="Identifier">&lt;/</span><span class="Statement">h2</span><span class="Identifier">&gt;</span>
<span class="lnr">114 </span>
<span class="lnr">115 </span><span class="Comment">&lt;!</span><span class="Comment">-- Begin Reserve Drawing Number --</span><span class="Comment">&gt;</span>
<span class="lnr">116 </span><span class="Function">&lt;</span><span class="Statement">form</span><span class="Function"> </span><span class="Type">action</span><span class="Function">=</span><span class="String">&quot;trustedthirdparty.htm&quot;</span><span class="Function"> </span><span class="Type">method</span><span class="Function">=</span><span class="String">&quot;get&quot;</span><span class="Function">&gt;</span>
<span class="lnr">117 </span><span class="Function">&lt;</span><span class="Statement">table</span><span class="Function">&gt;</span>
<span class="lnr">118 </span>    <span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;</span>
<span class="lnr">119 </span>        <span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;</span>Drawing Number:<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span>
<span class="lnr">120 </span>        <span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;text&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;drawingnum&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;&quot;</span><span class="Function"> /&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span>
<span class="lnr">121 </span>        <span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;submit&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;submit&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;Check&quot;</span><span class="Function"> /&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span>
<span class="lnr">122 </span>    <span class="Identifier">&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">123 </span><span class="Identifier">&lt;/</span><span class="Statement">table</span><span class="Identifier">&gt;</span>
<span class="lnr">124 </span><span class="Identifier">&lt;/</span><span class="Statement">form</span><span class="Identifier">&gt;</span>
<span class="lnr">125 </span><span class="Comment">&lt;!</span><span class="Comment">-- End Reserve Drawing Number --</span><span class="Comment">&gt;</span>
<span class="lnr">126 </span>
<span class="lnr">127 </span><span class="Comment">&lt;!</span><span class="Comment">-- Begin Create Random Numbers --</span><span class="Comment">&gt;</span>
<span class="lnr">128 </span><span class="Function">&lt;</span><span class="Statement">h2</span><span class="Function">&gt;</span><span class="Title">Create Random Numbers</span><span class="Identifier">&lt;/</span><span class="Statement">h2</span><span class="Identifier">&gt;</span>
<span class="lnr">129 </span><span class="Function">&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;dnum&quot;</span><span class="Function">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">h3</span><span class="Function">&gt;</span><span class="Title">Step 1: Reserve a Drawing Number</span><span class="Identifier">&lt;/</span><span class="Statement">h3</span><span class="Identifier">&gt;</span>
<span class="lnr">130 </span><span class="Special">&lt;?php</span>
<span class="lnr">131 </span>
<span class="lnr">132 </span><span class="Statement">if</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">makedrawingnumber</span>'<span class="Special">]))</span>
<span class="lnr">133 </span><span class="Special">{</span>
<span class="lnr">134 </span>    <span class="Operator">$</span><span class="Identifier">reviewtime</span> <span class="Operator">=</span> <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">prereview</span>'<span class="Special">]</span>;
<span class="lnr">135 </span>
<span class="lnr">136 </span>    <span class="Operator">$</span><span class="Identifier">starttime</span> <span class="Operator">=</span> <span class="Function">time</span><span class="Special">()</span>;
<span class="lnr">137 </span>    <span class="Operator">$</span><span class="Identifier">drawingdate</span> <span class="Operator">=</span> <span class="Function">date</span><span class="Special">(</span>&quot;<span class="String">D M j G:i:s T Y</span>&quot;, <span class="Operator">$</span><span class="Identifier">reviewtime</span> <span class="Operator">+</span> <span class="Operator">$</span><span class="Identifier">starttime</span><span class="Special">)</span>;
<span class="lnr">138 </span>    <span class="Operator">$</span><span class="Identifier">password</span> <span class="Operator">=</span> <span class="Function">bin2hex</span><span class="Special">(</span><span class="Function">mcrypt_create_iv</span><span class="Special">(</span><span class="Constant">16</span>, MCRYPT_DEV_URANDOM<span class="Special">))</span>;
<span class="lnr">139 </span>    <span class="Operator">$</span><span class="Identifier">passwordhash</span> <span class="Operator">=</span> hash<span class="Special">(</span>&quot;<span class="String">SHA256</span>&quot;, <span class="Operator">$</span><span class="Identifier">password</span><span class="Special">)</span>;
<span class="lnr">140 </span>    <span class="Function">mysql_query</span><span class="Special">(</span>&quot;<span class="String">INSERT INTO drawings (complete, passwordhash, starttime, reviewtime) VALUES (0, '</span><span class="Operator">$</span><span class="Identifier">passwordhash</span><span class="String">', '</span><span class="Operator">$</span><span class="Identifier">starttime</span><span class="String">', '</span><span class="Operator">$</span><span class="Identifier">reviewtime</span><span class="String">')</span>&quot;<span class="Special">)</span>;
<span class="lnr">141 </span>    <span class="Operator">$</span><span class="Identifier">drawingnum</span> <span class="Operator">=</span> <span class="Function">mysql_insert_id</span><span class="Special">()</span>;
<span class="lnr">142 </span>    <span class="Operator">$</span><span class="Identifier">url</span> <span class="Operator">=</span> &quot;<span class="String"><a href="https://defuse.ca/trustedthirdparty.htm?drawingnum=">https://defuse.ca/trustedthirdparty.htm?drawingnum=</a></span>&quot; <span class="Operator">.</span> <span class="Operator">$</span><span class="Identifier">drawingnum</span>;
<span class="lnr">143 </span>    <span class="Special">?&gt;</span>
<span class="lnr">144 </span>        <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #C9FFD1; border: solid 2px black; margin:20px; padding-left:10px; padding-right: 10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">145 </span>        <span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">Your Drawing Number Has Been Reserved...</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">146 </span>        Your drawing number is: <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="Special">&lt;?</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">drawingnum</span>; <span class="Special">?&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">147 </span>        Your passcode is: <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="Special">&lt;?</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">password</span>; <span class="Special">?&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">148 </span>        You will be able to do the drawing after <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">drawingdate</span>; <span class="Special">?&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">149 </span>        <span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">Please remember this information</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span>. Keep your password safe. You will need the drawing number and password to complete the actual drawing.<span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">150 </span>        <span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>Give your clients the following URL:<span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">151 </span>        <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">href</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">url</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function">&gt;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">url</span>; <span class="Special">?&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">152 </span>        <span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>This allows them to see that the drawing number has been reserved BEFORE the drawing took place, which proves to them that you can't redo the drawing over and over until TRENT picks the &quot;right numbers&quot;. Your clients can also get to that page by entering the drawing number in the &quot;Validate Random Numbers&quot; section above.<span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">153 </span>        <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">154 </span>    <span class="Special">&lt;?</span>
<span class="lnr">155 </span><span class="Special">}</span>
<span class="lnr">156 </span>
<span class="lnr">157 </span><span class="Special">?&gt;</span>
<span class="lnr">158 </span><span class="Function">&lt;</span><span class="Statement">form</span><span class="Function"> </span><span class="Type">action</span><span class="Function">=</span><span class="String">&quot;trustedthirdparty.htm#dnum&quot;</span><span class="Function"> </span><span class="Type">method</span><span class="Function">=</span><span class="String">&quot;post&quot;</span><span class="Function">&gt;</span>
<span class="lnr">159 </span>
<span class="lnr">160 </span>Review time:
<span class="lnr">161 </span>                <span class="Function">&lt;</span><span class="Statement">select</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;prereview&quot;</span><span class="Function">&gt;</span>
<span class="lnr">162 </span>                    <span class="Function">&lt;</span><span class="Statement">option</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;0&quot;</span><span class="Function"> </span><span class="Type">selected</span><span class="Function">=</span><span class="String">&quot;selected&quot;</span><span class="Function"> &gt;</span>Instant<span class="Identifier">&lt;/</span><span class="Statement">option</span><span class="Identifier">&gt;</span>
<span class="lnr">163 </span>                    <span class="Function">&lt;</span><span class="Statement">option</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;21600&quot;</span><span class="Function"> </span><span class="Type">selected</span><span class="Function">=</span><span class="String">&quot;selected&quot;</span><span class="Function"> &gt;</span>6 Hours<span class="Identifier">&lt;/</span><span class="Statement">option</span><span class="Identifier">&gt;</span>
<span class="lnr">164 </span>                    <span class="Function">&lt;</span><span class="Statement">option</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;86400&quot;</span><span class="Function"> </span><span class="Type">selected</span><span class="Function">=</span><span class="String">&quot;selected&quot;</span><span class="Function"> &gt;</span>24 hours<span class="Identifier">&lt;/</span><span class="Statement">option</span><span class="Identifier">&gt;</span>
<span class="lnr">165 </span>                    <span class="Function">&lt;</span><span class="Statement">option</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;345600&quot;</span><span class="Function">&gt;</span>4 days<span class="Identifier">&lt;/</span><span class="Statement">option</span><span class="Identifier">&gt;</span>
<span class="lnr">166 </span>                    <span class="Function">&lt;</span><span class="Statement">option</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;518400&quot;</span><span class="Function">&gt;</span>6 days<span class="Identifier">&lt;/</span><span class="Statement">option</span><span class="Identifier">&gt;</span>
<span class="lnr">167 </span>                    <span class="Function">&lt;</span><span class="Statement">option</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;1123200&quot;</span><span class="Function">&gt;</span>13 days<span class="Identifier">&lt;/</span><span class="Statement">option</span><span class="Identifier">&gt;</span>
<span class="lnr">168 </span>                    <span class="Function">&lt;</span><span class="Statement">option</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;2592000&quot;</span><span class="Function">&gt;</span>30 days<span class="Identifier">&lt;/</span><span class="Statement">option</span><span class="Identifier">&gt;</span>
<span class="lnr">169 </span>                <span class="Identifier">&lt;/</span><span class="Statement">select</span><span class="Identifier">&gt;</span>
<span class="lnr">170 </span>
<span class="lnr">171 </span><span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;submit&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;makedrawingnumber&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;Reserve a Drawing Number&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">172 </span><span class="Identifier">&lt;/</span><span class="Statement">form</span><span class="Identifier">&gt;</span>
<span class="lnr">173 </span><span class="Function">&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;create&quot;</span><span class="Function">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">h3</span><span class="Function">&gt;</span><span class="Title">Step 2: Create Random Numbers</span><span class="Identifier">&lt;/</span><span class="Statement">h3</span><span class="Identifier">&gt;</span>
<span class="lnr">174 </span><span class="Special">&lt;?php</span>
<span class="lnr">175 </span><span class="Statement">if</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">create</span>'<span class="Special">]))</span>
<span class="lnr">176 </span><span class="Special">{</span>
<span class="lnr">177 </span>    <span class="Operator">$</span><span class="Identifier">drawingnum</span> <span class="Operator">=</span> <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">drawingnumber</span>'<span class="Special">]</span>;
<span class="lnr">178 </span>    <span class="Operator">$</span><span class="Identifier">passcode</span> <span class="Operator">=</span> <span class="Function">trim</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">passcode</span>'<span class="Special">])</span>;
<span class="lnr">179 </span>    <span class="Operator">$</span><span class="Identifier">name</span> <span class="Operator">=</span> <span class="Function">trim</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">name</span>'<span class="Special">])</span>;
<span class="lnr">180 </span>    <span class="Operator">$</span><span class="Identifier">description</span> <span class="Operator">=</span> <span class="Function">trim</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">description</span>'<span class="Special">])</span>;
<span class="lnr">181 </span>
<span class="lnr">182 </span>    <span class="Operator">$</span><span class="Identifier">q</span> <span class="Operator">=</span> <span class="Function">mysql_query</span><span class="Special">(</span>&quot;<span class="String">SELECT * FROM drawings WHERE drawingnum='</span><span class="Operator">$</span><span class="Identifier">drawingnum</span><span class="String">'</span>&quot;<span class="Special">)</span>;
<span class="lnr">183 </span>    <span class="Statement">if</span><span class="Special">(</span><span class="Function">mysql_num_rows</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">q</span><span class="Special">)</span> <span class="Statement">&gt;</span> <span class="Constant">0</span><span class="Special">)</span>
<span class="lnr">184 </span>    <span class="Special">{</span>
<span class="lnr">185 </span>        <span class="Operator">$</span><span class="Identifier">info</span> <span class="Operator">=</span> <span class="Function">mysql_fetch_array</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">q</span><span class="Special">)</span>;
<span class="lnr">186 </span>        <span class="Operator">$</span><span class="Identifier">passwordHash</span> <span class="Operator">=</span> <span class="Operator">$</span><span class="Identifier">info</span><span class="Special">[</span>'<span class="String">passwordhash</span>'<span class="Special">]</span>;
<span class="lnr">187 </span>        <span class="Operator">$</span><span class="Identifier">drawingtime</span> <span class="Operator">=</span> <span class="Operator">$</span><span class="Identifier">info</span><span class="Special">[</span>'<span class="String">starttime</span>'<span class="Special">]</span> <span class="Operator">+</span> <span class="Operator">$</span><span class="Identifier">info</span><span class="Special">[</span>'<span class="String">reviewtime</span>'<span class="Special">]</span>;
<span class="lnr">188 </span>
<span class="lnr">189 </span>        <span class="Operator">$</span><span class="Identifier">randlines1</span> <span class="Operator">=</span> <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">randlines1</span>'<span class="Special">]</span>;
<span class="lnr">190 </span>        <span class="Operator">$</span><span class="Identifier">randlines2</span> <span class="Operator">=</span> <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">randlines2</span>'<span class="Special">]</span>;
<span class="lnr">191 </span>        <span class="Operator">$</span><span class="Identifier">randlines3</span> <span class="Operator">=</span> <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">randlines3</span>'<span class="Special">]</span>;
<span class="lnr">192 </span>
<span class="lnr">193 </span>        <span class="Operator">$</span><span class="Identifier">noLineRepeat</span> <span class="Operator">=</span> <span class="Operator">!</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">chosentwice</span>'<span class="Special">])</span> <span class="Operator">&amp;&amp;</span> <span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">chosentwice</span>'<span class="Special">]</span> <span class="Statement">==</span> '<span class="String">true</span>'<span class="Special">)</span>;
<span class="lnr">194 </span>
<span class="lnr">195 </span>        <span class="Operator">$</span><span class="Identifier">rangelow</span> <span class="Operator">=</span> <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">lowval</span>'<span class="Special">]</span>;
<span class="lnr">196 </span>        <span class="Operator">$</span><span class="Identifier">rangehigh</span> <span class="Operator">=</span> <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">highval</span>'<span class="Special">]</span>;
<span class="lnr">197 </span>
<span class="lnr">198 </span>        <span class="Operator">$</span><span class="Identifier">numnums</span> <span class="Operator">=</span> <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">numgen</span>'<span class="Special">]</span>;
<span class="lnr">199 </span>
<span class="lnr">200 </span>
<span class="lnr">201 </span>        <span class="Operator">$</span><span class="Identifier">file1hash</span> <span class="Operator">=</span> <span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">file1hash</span>'<span class="Special">])</span> <span class="Operator">?</span> <span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">file1hash</span>'<span class="Special">])</span> <span class="Operator">:</span> <span class="Special">(</span>&quot;&quot;<span class="Special">)</span>;
<span class="lnr">202 </span>        <span class="Operator">$</span><span class="Identifier">file2hash</span> <span class="Operator">=</span> <span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">file2hash</span>'<span class="Special">])</span> <span class="Operator">?</span> <span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">file2hash</span>'<span class="Special">])</span> <span class="Operator">:</span> <span class="Special">(</span>&quot;&quot;<span class="Special">)</span>;
<span class="lnr">203 </span>        <span class="Operator">$</span><span class="Identifier">file3hash</span> <span class="Operator">=</span> <span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">file3hash</span>'<span class="Special">])</span> <span class="Operator">?</span> <span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">file3hash</span>'<span class="Special">])</span> <span class="Operator">:</span> <span class="Special">(</span>&quot;&quot;<span class="Special">)</span>;
<span class="lnr">204 </span>
<span class="lnr">205 </span>        <span class="Operator">$</span><span class="Identifier">file1path</span> <span class="Operator">=</span> &quot;&quot;;
<span class="lnr">206 </span>        <span class="Operator">$</span><span class="Identifier">file2path</span> <span class="Operator">=</span> &quot;&quot;;
<span class="lnr">207 </span>        <span class="Operator">$</span><span class="Identifier">file3path</span> <span class="Operator">=</span> &quot;&quot;;
<span class="lnr">208 </span>
<span class="lnr">209 </span>        <span class="Statement">if</span><span class="Special">(</span><span class="Function">ctype_xdigit</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">file1hash</span><span class="Special">))</span>
<span class="lnr">210 </span>        <span class="Special">{</span>
<span class="lnr">211 </span>            <span class="Operator">$</span><span class="Identifier">file1path</span> <span class="Operator">=</span> &quot;<span class="String">/tmp/</span><span class="Operator">$</span><span class="Identifier">file1hash</span>&quot;;
<span class="lnr">212 </span>        <span class="Special">}</span>
<span class="lnr">213 </span>        <span class="Statement">elseif</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>'<span class="String">file1</span>'<span class="Special">]))</span>
<span class="lnr">214 </span>        <span class="Special">{</span>
<span class="lnr">215 </span>            <span class="Operator">$</span><span class="Identifier">file1path</span> <span class="Operator">=</span> <span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file1</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]</span>;
<span class="lnr">216 </span>        <span class="Special">}</span>
<span class="lnr">217 </span>
<span class="lnr">218 </span>        <span class="Statement">if</span><span class="Special">(</span><span class="Function">ctype_xdigit</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">file2hash</span><span class="Special">))</span>
<span class="lnr">219 </span>        <span class="Special">{</span>
<span class="lnr">220 </span>            <span class="Operator">$</span><span class="Identifier">file2path</span> <span class="Operator">=</span> &quot;<span class="String">/tmp/</span><span class="Operator">$</span><span class="Identifier">file2hash</span>&quot;;
<span class="lnr">221 </span>        <span class="Special">}</span>
<span class="lnr">222 </span>        <span class="Statement">elseif</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>'<span class="String">file2</span>'<span class="Special">]))</span>
<span class="lnr">223 </span>        <span class="Special">{</span>
<span class="lnr">224 </span>            <span class="Operator">$</span><span class="Identifier">file2path</span> <span class="Operator">=</span> <span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file2</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]</span>;
<span class="lnr">225 </span>        <span class="Special">}</span>
<span class="lnr">226 </span>
<span class="lnr">227 </span>        <span class="Statement">if</span><span class="Special">(</span><span class="Function">ctype_xdigit</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">file3hash</span><span class="Special">))</span>
<span class="lnr">228 </span>        <span class="Special">{</span>
<span class="lnr">229 </span>            <span class="Operator">$</span><span class="Identifier">file3path</span> <span class="Operator">=</span> &quot;<span class="String">/tmp/</span><span class="Operator">$</span><span class="Identifier">file3hash</span>&quot;;
<span class="lnr">230 </span>        <span class="Special">}</span>
<span class="lnr">231 </span>        <span class="Statement">elseif</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>'<span class="String">file3</span>'<span class="Special">]))</span>
<span class="lnr">232 </span>        <span class="Special">{</span>
<span class="lnr">233 </span>            <span class="Operator">$</span><span class="Identifier">file3path</span> <span class="Operator">=</span> <span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file3</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]</span>;
<span class="lnr">234 </span>        <span class="Special">}</span>
<span class="lnr">235 </span>
<span class="lnr">236 </span>        <span class="Statement">if</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">thispasshash</span> <span class="Operator">=</span> hash<span class="Special">(</span>&quot;<span class="String">SHA256</span>&quot;, <span class="Operator">$</span><span class="Identifier">passcode</span><span class="Special">)</span> <span class="Statement">!=</span> <span class="Operator">$</span><span class="Identifier">passwordHash</span><span class="Special">)</span>
<span class="lnr">237 </span>        <span class="Special">{</span>
<span class="lnr">238 </span>        <span class="Special">?&gt;</span>
<span class="lnr">239 </span>            <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #FF9F9F; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">240 </span>            <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">Incorrect password for drawing #</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">drawingnum</span> <span class="Special">?&gt;</span><span class="htmlBold">.</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">241 </span>            <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">242 </span>        <span class="Special">&lt;?</span>
<span class="lnr">243 </span>        <span class="Special">}</span>
<span class="lnr">244 </span>        <span class="Statement">elseif</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">info</span><span class="Special">[</span>'<span class="String">complete</span>'<span class="Special">]</span> <span class="Statement">!=</span> '<span class="String">0</span>'<span class="Special">)</span>
<span class="lnr">245 </span>        <span class="Special">{</span>
<span class="lnr">246 </span>        <span class="Special">?&gt;</span>
<span class="lnr">247 </span>            <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #FF9F9F; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">248 </span>            <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">The random numbers for drawing #</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">drawingnum</span> <span class="Special">?&gt;</span><span class="htmlBold"> have already been chosen.</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">249 </span>            <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">250 </span>        <span class="Special">&lt;?</span>
<span class="lnr">251 </span>        <span class="Special">}</span>
<span class="lnr">252 </span>        <span class="Statement">elseif</span><span class="Special">(</span><span class="Function">time</span><span class="Special">()</span> <span class="Statement">&lt;</span> <span class="Operator">$</span><span class="Identifier">drawingtime</span><span class="Special">)</span>
<span class="lnr">253 </span>        <span class="Special">{</span>
<span class="lnr">254 </span>        <span class="Special">?&gt;</span>
<span class="lnr">255 </span>            <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #FF9F9F; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">256 </span>            <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">The review period for drawing #</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">drawingnum</span> <span class="Special">?&gt;</span><span class="htmlBold"> is not complete. You will be able to do the drawing after </span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">date</span><span class="Special">(</span>&quot;<span class="String">D M j G:i:s T Y</span>&quot;, <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">info</span><span class="Special">[</span>'<span class="String">starttime</span>'<span class="Special">]</span> <span class="Operator">+</span> <span class="Special">(</span><span class="Type">int</span><span class="Special">)</span><span class="Operator">$</span><span class="Identifier">info</span><span class="Special">[</span>'<span class="String">reviewtime</span>'<span class="Special">])</span>; <span class="Special">?&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">257 </span>            <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">258 </span>        <span class="Special">&lt;?</span>
<span class="lnr">259 </span>        <span class="Special">}</span>
<span class="lnr">260 </span>        <span class="Statement">elseif</span> <span class="Special">(</span><span class="Operator">$</span><span class="Identifier">rangelow</span> <span class="Statement">&gt;=</span> <span class="Operator">$</span><span class="Identifier">rangehigh</span> <span class="Operator">&amp;&amp;</span> <span class="Operator">$</span><span class="Identifier">numnums</span> <span class="Statement">!=</span> <span class="Constant">0</span><span class="Special">)</span>
<span class="lnr">261 </span>        <span class="Special">{</span>
<span class="lnr">262 </span>        <span class="Special">?&gt;</span>
<span class="lnr">263 </span>            <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #FF9F9F; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">264 </span>            <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">The number range is invalid.</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span>
<span class="lnr">265 </span>            <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">266 </span>        <span class="Special">&lt;?</span>
<span class="lnr">267 </span>        <span class="Special">}</span>
<span class="lnr">268 </span>        <span class="Statement">elseif</span> <span class="Special">(</span><span class="Operator">$</span><span class="Identifier">numnums</span> <span class="Statement">&lt;</span> <span class="Constant">0</span> <span class="Operator">||</span> <span class="Operator">$</span><span class="Identifier">randlines1</span> <span class="Statement">&lt;</span> <span class="Constant">0</span> <span class="Operator">||</span> <span class="Operator">$</span><span class="Identifier">randlines2</span> <span class="Statement">&lt;</span> <span class="Constant">0</span> <span class="Operator">||</span> <span class="Operator">$</span><span class="Identifier">randlines3</span> <span class="Statement">&lt;</span> <span class="Constant">0</span><span class="Special">)</span>
<span class="lnr">269 </span>        <span class="Special">{</span>
<span class="lnr">270 </span>        <span class="Special">?&gt;</span>
<span class="lnr">271 </span>            <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #FF9F9F; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">272 </span>            <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">We couldn't possibly generate a NEGATIVE amount of random numbers...</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span>
<span class="lnr">273 </span>            <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">274 </span>        <span class="Special">&lt;?</span>
<span class="lnr">275 </span>        <span class="Special">}</span>
<span class="lnr">276 </span>        <span class="Statement">elseif</span> <span class="Special">(</span><span class="Operator">$</span><span class="Identifier">numnums</span> <span class="Statement">&gt;</span> <span class="Constant">1000</span> <span class="Operator">||</span> <span class="Operator">$</span><span class="Identifier">randlines1</span> <span class="Statement">&gt;</span> <span class="Constant">1000</span> <span class="Operator">||</span> <span class="Operator">$</span><span class="Identifier">randlines2</span> <span class="Statement">&gt;</span> <span class="Constant">1000</span> <span class="Operator">||</span> <span class="Operator">$</span><span class="Identifier">randlines3</span> <span class="Statement">&gt;</span> <span class="Constant">1000</span><span class="Special">)</span>
<span class="lnr">277 </span>        <span class="Special">{</span>
<span class="lnr">278 </span>        <span class="Special">?&gt;</span>
<span class="lnr">279 </span>            <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #FF9F9F; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">280 </span>            <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">Sorry, we can only generate 1000 random numbers at a time.</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span>
<span class="lnr">281 </span>            <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">282 </span>        <span class="Special">&lt;?</span>
<span class="lnr">283 </span>        <span class="Special">}</span>
<span class="lnr">284 </span>        <span class="Statement">elseif</span><span class="Special">(</span><span class="Operator">!</span>AllFilesUnder50<span class="Special">())</span>
<span class="lnr">285 </span>        <span class="Special">{</span>
<span class="lnr">286 </span>        <span class="Special">?&gt;</span>
<span class="lnr">287 </span>            <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #FF9F9F; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">288 </span>            <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">Sorry, maximum file size is 50MB.</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span>
<span class="lnr">289 </span>            <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">290 </span>        <span class="Special">&lt;?</span>
<span class="lnr">291 </span>        <span class="Special">}</span>
<span class="lnr">292 </span>        <span class="Statement">elseif</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">noLineRepeat</span> <span class="Operator">&amp;&amp;</span> <span class="Special">(</span><span class="Operator">!</span>EnoughLines<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">file1path</span>, <span class="Operator">$</span><span class="Identifier">randlines1</span><span class="Special">)</span> <span class="Operator">||</span>
<span class="lnr">293 </span>                <span class="Operator">!</span>EnoughLines<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">file2path</span>, <span class="Operator">$</span><span class="Identifier">randlines2</span><span class="Special">)</span> <span class="Operator">||</span>
<span class="lnr">294 </span>                <span class="Operator">!</span>EnoughLines<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">file3path</span>, <span class="Operator">$</span><span class="Identifier">randlines3</span><span class="Special">)))</span>
<span class="lnr">295 </span>        <span class="Special">{</span>
<span class="lnr">296 </span>        <span class="Special">?&gt;</span>
<span class="lnr">297 </span>            <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #FF9F9F; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">298 </span>            <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">One of the files doesn't have enough lines to be able to choose the requested number of lines.</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span>
<span class="lnr">299 </span>            <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">300 </span>        <span class="Special">&lt;?</span>
<span class="lnr">301 </span>        <span class="Special">}</span>
<span class="lnr">302 </span>        <span class="Statement">else</span>
<span class="lnr">303 </span>        <span class="Special">{</span>
<span class="lnr">304 </span>            <span class="Statement">if</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">confirmed</span>'<span class="Special">])</span> <span class="Operator">&amp;&amp;</span> <span class="Operator">$</span><span class="Identifier">_POST</span><span class="Special">[</span>'<span class="String">confirmed</span>'<span class="Special">]</span> <span class="Statement">==</span> &quot;<span class="String">true</span>&quot;<span class="Special">)</span>
<span class="lnr">305 </span>            <span class="Special">{</span>
<span class="lnr">306 </span>                <span class="Operator">$</span><span class="Identifier">userprintout</span> <span class="Operator">=</span> &quot;<span class="String">NAME: </span><span class="Operator">$</span><span class="Identifier">name</span><span class="Special">\n</span>&quot;;
<span class="lnr">307 </span>                <span class="Operator">$</span><span class="Identifier">userprintout</span> <span class="Operator">.=</span> &quot;<span class="String">DESCRIPTION:</span><span class="Special">\n</span><span class="Operator">$</span><span class="Identifier">description</span>&quot;;
<span class="lnr">308 </span>
<span class="lnr">309 </span>                <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">=</span> &quot;<span class="String">DRAWING NUMBER: </span><span class="Operator">$</span><span class="Identifier">drawingnum</span><span class="Special">\n</span>&quot;;
<span class="lnr">310 </span>                <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> &quot;<span class="String">DRAWING DATE: </span>&quot; <span class="Operator">.</span> <span class="Function">date</span><span class="Special">(</span>&quot;<span class="String">D M j G:i:s T Y</span>&quot;<span class="Special">)</span> <span class="Operator">.</span> &quot;<span class="Special">\n</span>&quot;;
<span class="lnr">311 </span>                <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> &quot;<span class="String">AMOUNT OF NUMBERS: </span><span class="Operator">$</span><span class="Identifier">numnums</span><span class="Special">\n</span>&quot;;
<span class="lnr">312 </span>                <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> &quot;<span class="String">RANGE: </span><span class="Operator">$</span><span class="Identifier">rangelow</span><span class="String"> TO </span><span class="Operator">$</span><span class="Identifier">rangehigh</span><span class="Special">\n\n</span>&quot;;
<span class="lnr">313 </span>
<span class="lnr">314 </span>                <span class="Statement">if</span><span class="Special">(</span><span class="Function">ctype_xdigit</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">file1hash</span><span class="Special">)</span> <span class="Operator">&amp;&amp;</span> <span class="Function">file_exists</span><span class="Special">(</span>&quot;<span class="String">/tmp/</span><span class="Operator">$</span><span class="Identifier">file1hash</span>&quot;<span class="Special">))</span>
<span class="lnr">315 </span>                <span class="Special">{</span>
<span class="lnr">316 </span>                    <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> &quot;<span class="String">FILE1 SHA256: </span><span class="Operator">$</span><span class="Identifier">file1hash</span><span class="Special">\n\n</span>&quot;;
<span class="lnr">317 </span>                    <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> GetRandomLinesOutput<span class="Special">(</span>&quot;<span class="String">/tmp/</span><span class="Operator">$</span><span class="Identifier">file1hash</span>&quot;, <span class="Operator">$</span><span class="Identifier">randlines1</span>, <span class="Operator">$</span><span class="Identifier">noLineRepeat</span><span class="Special">)</span>;
<span class="lnr">318 </span>                <span class="Special">}</span>
<span class="lnr">319 </span>
<span class="lnr">320 </span>                <span class="Statement">if</span><span class="Special">(</span><span class="Function">ctype_xdigit</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">file2hash</span><span class="Special">)</span> <span class="Operator">&amp;&amp;</span> <span class="Function">file_exists</span><span class="Special">(</span>&quot;<span class="String">/tmp/</span><span class="Operator">$</span><span class="Identifier">file2hash</span>&quot;<span class="Special">))</span>
<span class="lnr">321 </span>                <span class="Special">{</span>
<span class="lnr">322 </span>                    <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> &quot;<span class="String">FILE2 SHA256: </span><span class="Operator">$</span><span class="Identifier">file2hash</span><span class="Special">\n\n</span>&quot;;
<span class="lnr">323 </span>                    <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> GetRandomLinesOutput<span class="Special">(</span>&quot;<span class="String">/tmp/</span><span class="Operator">$</span><span class="Identifier">file2hash</span>&quot;, <span class="Operator">$</span><span class="Identifier">randlines2</span>, <span class="Operator">$</span><span class="Identifier">noLineRepeat</span><span class="Special">)</span>;
<span class="lnr">324 </span>                <span class="Special">}</span>
<span class="lnr">325 </span>
<span class="lnr">326 </span>                <span class="Statement">if</span><span class="Special">(</span><span class="Function">ctype_xdigit</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">file3hash</span><span class="Special">)</span> <span class="Operator">&amp;&amp;</span> <span class="Function">file_exists</span><span class="Special">(</span>&quot;<span class="String">/tmp/</span><span class="Operator">$</span><span class="Identifier">file3hash</span>&quot;<span class="Special">))</span>
<span class="lnr">327 </span>                <span class="Special">{</span>
<span class="lnr">328 </span>                    <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> &quot;<span class="String">FILE3 SHA256: </span><span class="Operator">$</span><span class="Identifier">file3hash</span><span class="Special">\n\n</span>&quot;;
<span class="lnr">329 </span>                    <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> GetRandomLinesOutput<span class="Special">(</span>&quot;<span class="String">/tmp/</span><span class="Operator">$</span><span class="Identifier">file3hash</span>&quot;, <span class="Operator">$</span><span class="Identifier">randlines3</span>, <span class="Operator">$</span><span class="Identifier">noLineRepeat</span><span class="Special">)</span>;
<span class="lnr">330 </span>                <span class="Special">}</span>
<span class="lnr">331 </span>
<span class="lnr">332 </span>                <span class="Statement">for</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">i</span> <span class="Operator">=</span> <span class="Constant">1</span>; <span class="Operator">$</span><span class="Identifier">i</span> <span class="Statement">&lt;=</span> <span class="Operator">$</span><span class="Identifier">numnums</span>; <span class="Operator">$</span><span class="Identifier">i</span><span class="Operator">++</span><span class="Special">)</span>
<span class="lnr">333 </span>                <span class="Special">{</span>
<span class="lnr">334 </span>                    <span class="Operator">$</span><span class="Identifier">randsrc</span> <span class="Operator">=</span> <span class="Function">mcrypt_create_iv</span><span class="Special">(</span><span class="Constant">32</span>, MCRYPT_DEV_URANDOM<span class="Special">)</span>;
<span class="lnr">335 </span>                    <span class="Operator">$</span><span class="Identifier">randnum</span> <span class="Operator">=</span> SelectRandomNumber<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">randsrc</span>, <span class="Operator">$</span><span class="Identifier">rangelow</span>, <span class="Operator">$</span><span class="Identifier">rangehigh</span><span class="Special">)</span>;
<span class="lnr">336 </span>                    <span class="Operator">$</span><span class="Identifier">srchex</span> <span class="Operator">=</span> <span class="Function">bin2hex</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">randsrc</span><span class="Special">)</span>;
<span class="lnr">337 </span>                    <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> &quot;<span class="String">RANDOM NUMBER NUMBER </span><span class="Operator">$</span><span class="Identifier">i</span><span class="String">: </span><span class="Operator">$</span><span class="Identifier">randnum</span><span class="Special">\n</span>&quot;;
<span class="lnr">338 </span>                <span class="Special">}</span>
<span class="lnr">339 </span>
<span class="lnr">340 </span>                <span class="Operator">$</span><span class="Identifier">msafeprintout</span> <span class="Operator">=</span> <span class="Function">mysql_real_escape_string</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">printout</span><span class="Special">)</span>;
<span class="lnr">341 </span>                <span class="Operator">$</span><span class="Identifier">msafeuserprintout</span> <span class="Operator">=</span> <span class="Function">mysql_real_escape_string</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">userprintout</span><span class="Special">)</span>;
<span class="lnr">342 </span>                <span class="Function">mysql_query</span><span class="Special">(</span>&quot;<span class="String">UPDATE drawings SET complete='1', printout='</span><span class="Operator">$</span><span class="Identifier">msafeprintout</span><span class="String">', userprintout='</span><span class="Operator">$</span><span class="Identifier">msafeuserprintout</span><span class="String">' WHERE drawingnum='</span><span class="Operator">$</span><span class="Identifier">drawingnum</span><span class="String">'</span>&quot;<span class="Special">)</span>;
<span class="lnr">343 </span>
<span class="lnr">344 </span>                <span class="Operator">$</span><span class="Identifier">url</span> <span class="Operator">=</span> &quot;<span class="String"><a href="https://defuse.ca/trustedthirdparty.htm?drawingnum=">https://defuse.ca/trustedthirdparty.htm?drawingnum=</a></span><span class="Operator">$</span><span class="Identifier">drawingnum</span>&quot;;
<span class="lnr">345 </span>                <span class="Special">?&gt;</span>
<span class="lnr">346 </span>                <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #C9FFD1; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">347 </span>                <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">Drawing Complete!</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">348 </span>                Follow this URL to see the results:<span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">349 </span>                <span class="Function">&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">href</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">url</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function">&gt;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">url</span>; <span class="Special">?&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;</span>
<span class="lnr">350 </span>                <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">351 </span>                <span class="Special">&lt;?</span>
<span class="lnr">352 </span>
<span class="lnr">353 </span>            <span class="Special">}</span>
<span class="lnr">354 </span>            <span class="Statement">else</span>
<span class="lnr">355 </span>            <span class="Special">{</span>
<span class="lnr">356 </span>            <span class="Special">?&gt;</span>
<span class="lnr">357 </span>                <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #C9FFD1; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">358 </span>                <span class="Function">&lt;</span><span class="Statement">h3</span><span class="Function"> </span><span class="Type">class</span><span class="Function">=</span><span class="String">&quot;nopaddingatall&quot;</span><span class="Function">&gt;</span><span class="Title">Confirm Drawing #</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">drawingnum</span>; <span class="Special">?&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">h3</span><span class="Identifier">&gt;</span>
<span class="lnr">359 </span>                <span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>Please confirm the parameters you provided. <span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">360 </span>                <span class="Function">&lt;</span><span class="Statement">h4</span><span class="Function"> </span><span class="Type">class</span><span class="Function">=</span><span class="String">&quot;nopaddingatall&quot;</span><span class="Function">&gt;</span><span class="Title">Name</span><span class="Identifier">&lt;/</span><span class="Statement">h4</span><span class="Identifier">&gt;</span>
<span class="lnr">361 </span>                <span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">name</span>, ENT_QUOTES<span class="Special">)</span>; <span class="Special">?&gt;</span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">362 </span>                <span class="Function">&lt;</span><span class="Statement">h4</span><span class="Function"> </span><span class="Type">class</span><span class="Function">=</span><span class="String">&quot;nopaddingatall&quot;</span><span class="Function">&gt;</span><span class="Title">Description</span><span class="Identifier">&lt;/</span><span class="Statement">h4</span><span class="Identifier">&gt;</span>
<span class="lnr">363 </span>                <span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">description</span>, ENT_QUOTES<span class="Special">)</span>; <span class="Special">?&gt;</span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">364 </span>                <span class="Function">&lt;</span><span class="Statement">h4</span><span class="Function"> </span><span class="Type">class</span><span class="Function">=</span><span class="String">&quot;nopaddingatall&quot;</span><span class="Function">&gt;</span><span class="Title">File1</span><span class="Identifier">&lt;/</span><span class="Statement">h4</span><span class="Identifier">&gt;</span>
<span class="lnr">365 </span>                <span class="Special">&lt;?php</span>
<span class="lnr">366 </span>                    <span class="PreProc">echo</span> GetFileFileInfoHTML<span class="Special">(</span>&quot;<span class="String">file1</span>&quot;<span class="Special">)</span>;
<span class="lnr">367 </span>                    <span class="PreProc">echo</span> &quot;<span class="String">&lt;br /&gt;Random Lines: </span><span class="Operator">$</span><span class="Identifier">randlines1</span>&quot;;
<span class="lnr">368 </span>                <span class="Special">?&gt;</span>
<span class="lnr">369 </span>                <span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">370 </span>                <span class="Function">&lt;</span><span class="Statement">h4</span><span class="Function"> </span><span class="Type">class</span><span class="Function">=</span><span class="String">&quot;nopaddingatall&quot;</span><span class="Function">&gt;</span><span class="Title">File2</span><span class="Identifier">&lt;/</span><span class="Statement">h4</span><span class="Identifier">&gt;</span>
<span class="lnr">371 </span>                <span class="Special">&lt;?php</span>
<span class="lnr">372 </span>                    <span class="PreProc">echo</span> GetFileFileInfoHTML<span class="Special">(</span>&quot;<span class="String">file2</span>&quot;<span class="Special">)</span>;
<span class="lnr">373 </span>                    <span class="PreProc">echo</span> &quot;<span class="String">&lt;br /&gt;Random Lines: </span><span class="Operator">$</span><span class="Identifier">randlines2</span>&quot;;
<span class="lnr">374 </span>                <span class="Special">?&gt;</span>
<span class="lnr">375 </span>                <span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">376 </span>                <span class="Function">&lt;</span><span class="Statement">h4</span><span class="Function"> </span><span class="Type">class</span><span class="Function">=</span><span class="String">&quot;nopaddingatall&quot;</span><span class="Function">&gt;</span><span class="Title">File3</span><span class="Identifier">&lt;/</span><span class="Statement">h4</span><span class="Identifier">&gt;</span>
<span class="lnr">377 </span>                <span class="Special">&lt;?php</span>
<span class="lnr">378 </span>                    <span class="PreProc">echo</span> GetFileFileInfoHTML<span class="Special">(</span>&quot;<span class="String">file3</span>&quot;<span class="Special">)</span>;
<span class="lnr">379 </span>                    <span class="PreProc">echo</span> &quot;<span class="String">&lt;br /&gt;Random Lines: </span><span class="Operator">$</span><span class="Identifier">randlines3</span>&quot;;
<span class="lnr">380 </span>                <span class="Special">?&gt;</span>
<span class="lnr">381 </span>                <span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">382 </span>                <span class="Function">&lt;</span><span class="Statement">h4</span><span class="Function"> </span><span class="Type">class</span><span class="Function">=</span><span class="String">&quot;nopaddingatall&quot;</span><span class="Function">&gt;</span><span class="Title">Number Range</span><span class="Identifier">&lt;/</span><span class="Statement">h4</span><span class="Identifier">&gt;</span>
<span class="lnr">383 </span>                <span class="Special">&lt;?php</span> <span class="PreProc">echo</span> &quot;<span class="Operator">$</span><span class="Identifier">rangelow</span><span class="String"> to </span><span class="Operator">$</span><span class="Identifier">rangehigh</span>&quot;; <span class="Special">?&gt;</span>
<span class="lnr">384 </span>                <span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">385 </span>                <span class="Function">&lt;</span><span class="Statement">h4</span><span class="Function"> </span><span class="Type">class</span><span class="Function">=</span><span class="String">&quot;nopaddingatall&quot;</span><span class="Function">&gt;</span><span class="Title">Amount of Numbers:</span><span class="Identifier">&lt;/</span><span class="Statement">h4</span><span class="Identifier">&gt;</span>
<span class="lnr">386 </span>                <span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">numnums</span>; <span class="Special">?&gt;</span>
<span class="lnr">387 </span>                <span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">388 </span>                <span class="Function">&lt;</span><span class="Statement">form</span><span class="Function"> </span><span class="Type">action</span><span class="Function">=</span><span class="String">&quot;trustedthirdparty.htm#create&quot;</span><span class="Function"> </span><span class="Type">method</span><span class="Function">=</span><span class="String">&quot;post&quot;</span><span class="Function">&gt;</span>
<span class="lnr">389 </span>                <span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">These settings </span><span class="Function">&lt;</span><span class="Statement">u</span><span class="Function">&gt;</span><span class="htmlBoldUnderline">CAN NOT BE CHANGED</span><span class="Identifier">&lt;/</span><span class="Statement">u</span><span class="Identifier">&gt;</span><span class="htmlBold"> after the random numbers have been selected.</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">390 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;submit&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;create&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;These values are correct, draw my random numbers!&quot;</span><span class="Function"> /&gt;</span><span class="Special">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;submit&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;cancel&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;Cancel&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">391 </span>                <span class="Special">&lt;?php</span>
<span class="lnr">392 </span>                    <span class="Operator">$</span><span class="Identifier">file1hash</span> <span class="Operator">=</span> &quot;&quot;;
<span class="lnr">393 </span>                    <span class="Operator">$</span><span class="Identifier">file2hash</span> <span class="Operator">=</span> &quot;&quot;;
<span class="lnr">394 </span>                    <span class="Operator">$</span><span class="Identifier">file3hash</span> <span class="Operator">=</span> &quot;&quot;;
<span class="lnr">395 </span>
<span class="lnr">396 </span>                    <span class="Comment">//move files to /tmp/sha256</span>
<span class="lnr">397 </span>                    <span class="Statement">if</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file1</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span> <span class="Operator">&amp;&amp;</span> <span class="Function">file_exists</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file1</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]))</span>
<span class="lnr">398 </span>                    <span class="Special">{</span>
<span class="lnr">399 </span>                        <span class="Operator">$</span><span class="Identifier">file1hash</span> <span class="Operator">=</span> hash_file<span class="Special">(</span>&quot;<span class="String">SHA256</span>&quot;, <span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file1</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span>;
<span class="lnr">400 </span>                        <span class="Function">rename</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file1</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]</span>, &quot;<span class="String">/tmp/</span><span class="Operator">$</span><span class="Identifier">file1hash</span>&quot;<span class="Special">)</span>;
<span class="lnr">401 </span>                    <span class="Special">}</span>
<span class="lnr">402 </span>                    <span class="Statement">if</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file2</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span> <span class="Operator">&amp;&amp;</span> <span class="Function">file_exists</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file2</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]))</span>
<span class="lnr">403 </span>                    <span class="Special">{</span>
<span class="lnr">404 </span>                        <span class="Operator">$</span><span class="Identifier">file2hash</span> <span class="Operator">=</span> hash_file<span class="Special">(</span>&quot;<span class="String">SHA256</span>&quot;, <span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file2</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span>;
<span class="lnr">405 </span>                        <span class="Function">rename</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file2</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]</span>, &quot;<span class="String">/tmp/</span><span class="Operator">$</span><span class="Identifier">file2hash</span>&quot;<span class="Special">)</span>;
<span class="lnr">406 </span>                    <span class="Special">}</span>
<span class="lnr">407 </span>                    <span class="Statement">if</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file3</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span> <span class="Operator">&amp;&amp;</span> <span class="Function">file_exists</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file3</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]))</span>
<span class="lnr">408 </span>                    <span class="Special">{</span>
<span class="lnr">409 </span>                        <span class="Operator">$</span><span class="Identifier">file3hash</span> <span class="Operator">=</span> hash_file<span class="Special">(</span>&quot;<span class="String">SHA256</span>&quot;, <span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file3</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span>;
<span class="lnr">410 </span>                        <span class="Function">rename</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file3</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]</span>, &quot;<span class="String">/tmp/</span><span class="Operator">$</span><span class="Identifier">file3hash</span>&quot;<span class="Special">)</span>;
<span class="lnr">411 </span>                    <span class="Special">}</span>
<span class="lnr">412 </span>                <span class="Special">?&gt;</span>
<span class="lnr">413 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;confirmed&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;true&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">414 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;drawingnumber&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">drawingnum</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">415 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;passcode&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">passcode</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">416 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;name&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">name</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">417 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;description&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">description</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">418 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;file1hash&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">file1hash</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">419 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;file2hash&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">file2hash</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">420 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;file3hash&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">file3hash</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">421 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;randlines1&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">randlines1</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">422 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;randlines2&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">randlines2</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">423 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;randlines3&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">randlines3</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">424 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;chosentwice&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="Statement">if</span><span class="Special">(</span><span class="Operator">!</span><span class="Operator">$</span><span class="Identifier">noLineRepeat</span><span class="Special">)</span> <span class="PreProc">echo</span> &quot;<span class="String">true</span>&quot;; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">425 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;lowval&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">rangelow</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">426 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;highval&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">rangehigh</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">427 </span>                <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;hidden&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;numgen&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Function">htmlentities</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">numnums</span><span class="Special">)</span>; <span class="Special">?&gt;</span><span class="String">&quot;</span><span class="Function"> /&gt;</span>
<span class="lnr">428 </span>                <span class="Identifier">&lt;/</span><span class="Statement">form</span><span class="Identifier">&gt;</span>
<span class="lnr">429 </span>                <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">430 </span>            <span class="Special">&lt;?</span>
<span class="lnr">431 </span>            <span class="Special">}</span>
<span class="lnr">432 </span>        <span class="Special">}</span>
<span class="lnr">433 </span>    <span class="Special">}</span>
<span class="lnr">434 </span>    <span class="Statement">else</span>
<span class="lnr">435 </span>    <span class="Special">{</span>
<span class="lnr">436 </span>    <span class="Special">?&gt;</span>
<span class="lnr">437 </span>        <span class="Function">&lt;</span><span class="Statement">div</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;background-color: #FF9F9F; border: solid 2px black; margin:20px; padding:10px;&quot;</span><span class="Function">&gt;</span>
<span class="lnr">438 </span>        <span class="Function">&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">Drawing #</span><span class="Special">&lt;?php</span> <span class="PreProc">echo</span> <span class="Operator">$</span><span class="Identifier">drawingnum</span> <span class="Special">?&gt;</span><span class="htmlBold"> does not exist.</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">439 </span>        <span class="Identifier">&lt;/</span><span class="Statement">div</span><span class="Identifier">&gt;</span>
<span class="lnr">440 </span>    <span class="Special">&lt;?</span>
<span class="lnr">441 </span>    <span class="Special">}</span>
<span class="lnr">442 </span><span class="Special">}</span>
<span class="lnr">443 </span>
<span class="lnr">444 </span>
<span class="lnr">445 </span><span class="PreProc">function</span> GetFileChecksum<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">)</span>
<span class="lnr">446 </span><span class="Special">{</span>
<span class="lnr">447 </span>    <span class="Statement">if</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span> <span class="Operator">&amp;&amp;</span> <span class="Function">file_exists</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]))</span>
<span class="lnr">448 </span>    <span class="Special">{</span>
<span class="lnr">449 </span>        <span class="Statement">return</span> hash_file<span class="Special">(</span>&quot;<span class="String">SHA256</span>&quot;, <span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span>;
<span class="lnr">450 </span>    <span class="Special">}</span>
<span class="lnr">451 </span>    <span class="Statement">else</span>
<span class="lnr">452 </span>    <span class="Special">{</span>
<span class="lnr">453 </span>        <span class="Statement">return</span> &quot;<span class="String">NO FILE</span>&quot;;
<span class="lnr">454 </span>    <span class="Special">}</span>
<span class="lnr">455 </span><span class="Special">}</span>
<span class="lnr">456 </span>
<span class="lnr">457 </span><span class="PreProc">function</span> GetFileSizeHR<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">)</span>
<span class="lnr">458 </span><span class="Special">{</span>
<span class="lnr">459 </span>    <span class="Statement">if</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span> <span class="Operator">&amp;&amp;</span> <span class="Function">file_exists</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]))</span>
<span class="lnr">460 </span>    <span class="Special">{</span>
<span class="lnr">461 </span>        <span class="Statement">return</span> format_bytes<span class="Special">(</span><span class="Function">filesize</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]))</span>;
<span class="lnr">462 </span>    <span class="Special">}</span>
<span class="lnr">463 </span>    <span class="Statement">else</span>
<span class="lnr">464 </span>    <span class="Special">{</span>
<span class="lnr">465 </span>        <span class="Statement">return</span> &quot;<span class="String">NO FILE</span>&quot;;
<span class="lnr">466 </span>    <span class="Special">}</span>
<span class="lnr">467 </span><span class="Special">}</span>
<span class="lnr">468 </span>
<span class="lnr">469 </span><span class="PreProc">function</span> format_bytes<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">size</span><span class="Special">)</span> <span class="Special">{</span>
<span class="lnr">470 </span>    <span class="Operator">$</span><span class="Identifier">units</span> <span class="Operator">=</span> <span class="Type">array</span><span class="Special">(</span>'<span class="String"> B</span>', '<span class="String"> KB</span>', '<span class="String"> MB</span>', '<span class="String"> GB</span>', '<span class="String"> TB</span>'<span class="Special">)</span>;
<span class="lnr">471 </span>    <span class="Statement">for</span> <span class="Special">(</span><span class="Operator">$</span><span class="Identifier">i</span> <span class="Operator">=</span> <span class="Constant">0</span>; <span class="Operator">$</span><span class="Identifier">size</span> <span class="Statement">&gt;=</span> <span class="Constant">1024</span> <span class="Operator">&amp;&amp;</span> <span class="Operator">$</span><span class="Identifier">i</span> <span class="Statement">&lt;</span> <span class="Constant">4</span>; <span class="Operator">$</span><span class="Identifier">i</span><span class="Operator">++</span><span class="Special">)</span> <span class="Operator">$</span><span class="Identifier">size</span> <span class="Operator">/=</span> <span class="Constant">1024</span>;
<span class="lnr">472 </span>    <span class="Statement">return</span> <span class="Function">round</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">size</span>, <span class="Constant">2</span><span class="Special">)</span><span class="Operator">.</span><span class="Operator">$</span><span class="Identifier">units</span><span class="Special">[</span><span class="Operator">$</span><span class="Identifier">i</span><span class="Special">]</span>;
<span class="lnr">473 </span><span class="Special">}</span>
<span class="lnr">474 </span>
<span class="lnr">475 </span><span class="PreProc">function</span> GetFileName<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">)</span>
<span class="lnr">476 </span><span class="Special">{</span>
<span class="lnr">477 </span>    <span class="Statement">if</span><span class="Special">(</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">][</span>&quot;<span class="String">name</span>&quot;<span class="Special">])</span> <span class="Operator">&amp;&amp;</span> <span class="Function">file_exists</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">]))</span>
<span class="lnr">478 </span>    <span class="Special">{</span>
<span class="lnr">479 </span>        <span class="Statement">return</span> <span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">][</span>&quot;<span class="String">name</span>&quot;<span class="Special">]</span>;
<span class="lnr">480 </span>    <span class="Special">}</span>
<span class="lnr">481 </span>    <span class="Statement">else</span>
<span class="lnr">482 </span>    <span class="Special">{</span>
<span class="lnr">483 </span>        <span class="Statement">return</span> &quot;<span class="String">NO FILE</span>&quot;;
<span class="lnr">484 </span>    <span class="Special">}</span>
<span class="lnr">485 </span><span class="Special">}</span>
<span class="lnr">486 </span>
<span class="lnr">487 </span><span class="PreProc">function</span> GetFileFileInfoHTML<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">)</span>
<span class="lnr">488 </span><span class="Special">{</span>
<span class="lnr">489 </span>    <span class="Operator">$</span><span class="Identifier">filename</span> <span class="Operator">=</span> <span class="Function">htmlentities</span><span class="Special">(</span>GetFileName<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">)</span>, ENT_QUOTES<span class="Special">)</span>;
<span class="lnr">490 </span>    <span class="Operator">$</span><span class="Identifier">filesize</span> <span class="Operator">=</span> <span class="Function">htmlentities</span><span class="Special">(</span>GetFileSizeHR<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">)</span>, ENT_QUOTES<span class="Special">)</span>;
<span class="lnr">491 </span>    <span class="Operator">$</span><span class="Identifier">filesha256</span> <span class="Operator">=</span> <span class="Function">htmlentities</span><span class="Special">(</span>GetFileChecksum<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">postname</span><span class="Special">)</span>, ENT_QUOTES<span class="Special">)</span>;
<span class="lnr">492 </span>    <span class="PreProc">echo</span> &quot;<span class="String">Name: </span><span class="Operator">$</span><span class="Identifier">filename</span><span class="String"> &lt;br /&gt;Size: </span><span class="Operator">$</span><span class="Identifier">filesize</span><span class="String"> &lt;br /&gt;SHA256: </span><span class="Operator">$</span><span class="Identifier">filesha256</span>&quot;;
<span class="lnr">493 </span><span class="Special">}</span>
<span class="lnr">494 </span>
<span class="lnr">495 </span><span class="PreProc">function</span> AllFilesUnder50<span class="Special">()</span>
<span class="lnr">496 </span><span class="Special">{</span>
<span class="lnr">497 </span>    <span class="Statement">return</span> <span class="Special">(</span><span class="Operator">!</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file1</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span> <span class="Operator">||</span> <span class="Function">filesize</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file1</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span> <span class="Statement">&lt;</span> <span class="Constant">1024</span> <span class="Operator">*</span> <span class="Constant">1024</span> <span class="Operator">*</span> <span class="Constant">50</span><span class="Special">)</span> <span class="Operator">&amp;&amp;</span>
<span class="lnr">498 </span>        <span class="Special">(</span><span class="Operator">!</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file2</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span> <span class="Operator">||</span> <span class="Function">filesize</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file2</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span> <span class="Statement">&lt;</span> <span class="Constant">1024</span> <span class="Operator">*</span> <span class="Constant">1024</span> <span class="Operator">*</span> <span class="Constant">50</span><span class="Special">)</span> <span class="Operator">&amp;&amp;</span>
<span class="lnr">499 </span>        <span class="Special">(</span><span class="Operator">!</span><span class="Operator">isset</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file3</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span> <span class="Operator">||</span> <span class="Function">filesize</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">_FILES</span><span class="Special">[</span>&quot;<span class="String">file3</span>&quot;<span class="Special">][</span>&quot;<span class="String">tmp_name</span>&quot;<span class="Special">])</span> <span class="Statement">&lt;</span> <span class="Constant">1024</span> <span class="Operator">*</span> <span class="Constant">1024</span> <span class="Operator">*</span> <span class="Constant">50</span><span class="Special">)</span>;
<span class="lnr">500 </span><span class="Special">}</span>
<span class="lnr">501 </span>
<span class="lnr">502 </span><span class="PreProc">function</span> SelectRandomNumber<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">randombinary</span>, <span class="Operator">$</span><span class="Identifier">low</span>, <span class="Operator">$</span><span class="Identifier">high</span><span class="Special">)</span>
<span class="lnr">503 </span><span class="Special">{</span>
<span class="lnr">504 </span>    <span class="Operator">$</span><span class="Identifier">divisor</span> <span class="Operator">=</span> <span class="Function">abs</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">high</span> <span class="Operator">-</span> <span class="Operator">$</span><span class="Identifier">low</span> <span class="Operator">+</span> <span class="Constant">1</span><span class="Special">)</span>;
<span class="lnr">505 </span>    <span class="Operator">$</span><span class="Identifier">remainder</span> <span class="Operator">=</span> <span class="Constant">0</span>;
<span class="lnr">506 </span>    <span class="Statement">for</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">i</span> <span class="Operator">=</span> <span class="Constant">0</span>; <span class="Operator">$</span><span class="Identifier">i</span> <span class="Statement">&lt;</span> <span class="Constant">32</span>; <span class="Operator">$</span><span class="Identifier">i</span><span class="Operator">++</span><span class="Special">)</span>
<span class="lnr">507 </span>    <span class="Special">{</span>
<span class="lnr">508 </span>        <span class="Operator">$</span><span class="Identifier">total</span> <span class="Operator">=</span> <span class="Operator">$</span><span class="Identifier">remainder</span> <span class="Operator">*</span> <span class="Constant">256</span> <span class="Operator">+</span> <span class="Function">ord</span><span class="Special">(</span><span class="Function">substr</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">randombinary</span>, <span class="Operator">$</span><span class="Identifier">i</span>, <span class="Constant">1</span><span class="Special">))</span>;
<span class="lnr">509 </span>        <span class="Operator">$</span><span class="Identifier">remainder</span> <span class="Operator">=</span> <span class="Operator">$</span><span class="Identifier">total</span> <span class="Operator">%</span> <span class="Operator">$</span><span class="Identifier">divisor</span>;
<span class="lnr">510 </span>    <span class="Special">}</span>
<span class="lnr">511 </span>    <span class="Statement">return</span> <span class="Operator">$</span><span class="Identifier">low</span> <span class="Operator">+</span> <span class="Operator">$</span><span class="Identifier">remainder</span>;
<span class="lnr">512 </span><span class="Special">}</span>
<span class="lnr">513 </span>
<span class="lnr">514 </span><span class="PreProc">function</span> GetRandomFileLine<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">filepath</span>, <span class="Operator">$</span><span class="Identifier">exclude</span><span class="Special">)</span>
<span class="lnr">515 </span><span class="Special">{</span>
<span class="lnr">516 </span>    <span class="Operator">$</span><span class="Identifier">linecount</span> <span class="Operator">=</span> CountFileLines<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">filepath</span><span class="Special">)</span>;
<span class="lnr">517 </span>    <span class="Operator">$</span><span class="Identifier">randsrc</span> <span class="Operator">=</span> <span class="Function">mcrypt_create_iv</span><span class="Special">(</span><span class="Constant">32</span>, MCRYPT_DEV_URANDOM<span class="Special">)</span>;
<span class="lnr">518 </span>    <span class="Operator">$</span><span class="Identifier">srchex</span> <span class="Operator">=</span> <span class="Function">bin2hex</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">randsrc</span><span class="Special">)</span>;
<span class="lnr">519 </span>    <span class="Operator">$</span><span class="Identifier">randline</span> <span class="Operator">=</span> SelectRandomNumber<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">randsrc</span>, <span class="Constant">0</span>, <span class="Operator">$</span><span class="Identifier">linecount</span> <span class="Operator">-</span> <span class="Constant">1</span><span class="Special">)</span>;
<span class="lnr">520 </span>
<span class="lnr">521 </span>    <span class="Statement">if</span><span class="Special">(</span><span class="Function">in_array</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">randline</span>, <span class="Operator">$</span><span class="Identifier">exclude</span><span class="Special">))</span> <span class="Comment">//recursivly keep selecting random lines until we get one that hasn't been chosen yet</span>
<span class="lnr">522 </span>        <span class="Statement">return</span> GetRandomFileLine<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">filepath</span>, <span class="Operator">$</span><span class="Identifier">exclude</span><span class="Special">)</span>;
<span class="lnr">523 </span>
<span class="lnr">524 </span>    <span class="Operator">$</span><span class="Identifier">linetext</span> <span class="Operator">=</span> GetLineText<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">filepath</span>, <span class="Operator">$</span><span class="Identifier">randline</span><span class="Special">)</span>;
<span class="lnr">525 </span>
<span class="lnr">526 </span>    <span class="Statement">return</span> <span class="Type">array</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">randline</span>, <span class="Operator">$</span><span class="Identifier">srchex</span>, <span class="Operator">$</span><span class="Identifier">linetext</span><span class="Special">)</span>;
<span class="lnr">527 </span><span class="Special">}</span>
<span class="lnr">528 </span>
<span class="lnr">529 </span><span class="PreProc">function</span> GetLineText<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">filepath</span>, <span class="Operator">$</span><span class="Identifier">lineidx</span><span class="Special">)</span>
<span class="lnr">530 </span><span class="Special">{</span>
<span class="lnr">531 </span>    <span class="Operator">$</span><span class="Identifier">fh</span> <span class="Operator">=</span> <span class="Function">fopen</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">filepath</span>, '<span class="String">r</span>'<span class="Special">)</span>;
<span class="lnr">532 </span>    <span class="Operator">$</span><span class="Identifier">i</span> <span class="Operator">=</span> <span class="Constant">0</span>;
<span class="lnr">533 </span>    <span class="Statement">while</span><span class="Special">(</span><span class="Operator">!</span><span class="Function">feof</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">fh</span><span class="Special">))</span>
<span class="lnr">534 </span>    <span class="Special">{</span>
<span class="lnr">535 </span>        <span class="Operator">$</span><span class="Identifier">line</span> <span class="Operator">=</span> <span class="Function">fgets</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">fh</span>, <span class="Constant">1000</span><span class="Special">)</span>;
<span class="lnr">536 </span>        <span class="Statement">if</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">i</span> <span class="Statement">==</span> <span class="Operator">$</span><span class="Identifier">lineidx</span><span class="Special">)</span>
<span class="lnr">537 </span>            <span class="Statement">return</span> <span class="Operator">$</span><span class="Identifier">line</span>;
<span class="lnr">538 </span>        <span class="Operator">$</span><span class="Identifier">i</span><span class="Operator">++</span>;
<span class="lnr">539 </span>    <span class="Special">}</span>
<span class="lnr">540 </span>    <span class="Function">fclose</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">fh</span><span class="Special">)</span>;
<span class="lnr">541 </span>    <span class="Statement">return</span> <span class="Operator">$</span><span class="Identifier">i</span>;
<span class="lnr">542 </span><span class="Special">}</span>
<span class="lnr">543 </span>
<span class="lnr">544 </span><span class="PreProc">function</span> CountFileLines<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">filepath</span><span class="Special">)</span>
<span class="lnr">545 </span><span class="Special">{</span>
<span class="lnr">546 </span>    <span class="Statement">if</span><span class="Special">(</span><span class="Function">is_dir</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">filepath</span><span class="Special">))</span>
<span class="lnr">547 </span>        <span class="Statement">return</span> <span class="Constant">0</span>;
<span class="lnr">548 </span>    <span class="Operator">$</span><span class="Identifier">fh</span> <span class="Operator">=</span> <span class="Function">fopen</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">filepath</span>, '<span class="String">r</span>'<span class="Special">)</span>;
<span class="lnr">549 </span>    <span class="Operator">$</span><span class="Identifier">i</span> <span class="Operator">=</span> <span class="Constant">0</span>;
<span class="lnr">550 </span>    <span class="Statement">while</span><span class="Special">(</span><span class="Operator">!</span><span class="Function">feof</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">fh</span><span class="Special">))</span>
<span class="lnr">551 </span>    <span class="Special">{</span>
<span class="lnr">552 </span>        <span class="Function">fgets</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">fh</span><span class="Special">)</span>; <span class="Comment">//advance to the next line</span>
<span class="lnr">553 </span>        <span class="Operator">$</span><span class="Identifier">i</span><span class="Operator">++</span>;
<span class="lnr">554 </span>    <span class="Special">}</span>
<span class="lnr">555 </span>    <span class="Function">fclose</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">fh</span><span class="Special">)</span>;
<span class="lnr">556 </span>    <span class="Statement">return</span> <span class="Operator">$</span><span class="Identifier">i</span>;
<span class="lnr">557 </span><span class="Special">}</span>
<span class="lnr">558 </span>
<span class="lnr">559 </span><span class="PreProc">function</span> EnoughLines<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">path</span>, <span class="Operator">$</span><span class="Identifier">num</span><span class="Special">)</span>
<span class="lnr">560 </span><span class="Special">{</span>
<span class="lnr">561 </span>    <span class="Statement">return</span> <span class="Operator">!</span><span class="Function">file_exists</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">path</span><span class="Special">)</span> <span class="Operator">||</span> <span class="Operator">$</span><span class="Identifier">num</span> <span class="Statement">==</span> <span class="Constant">0</span> <span class="Operator">||</span>  CountFileLines<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">path</span><span class="Special">)</span> <span class="Statement">&gt;</span> <span class="Operator">$</span><span class="Identifier">num</span>;
<span class="lnr">562 </span><span class="Special">}</span>
<span class="lnr">563 </span>
<span class="lnr">564 </span><span class="PreProc">function</span> GetRandomLinesOutput<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">path</span>, <span class="Operator">$</span><span class="Identifier">numlines</span>, <span class="Operator">$</span><span class="Identifier">noLineRepeat</span><span class="Special">)</span>
<span class="lnr">565 </span><span class="Special">{</span>
<span class="lnr">566 </span>    <span class="Operator">$</span><span class="Identifier">exclude</span> <span class="Operator">=</span> <span class="Type">array</span><span class="Special">()</span>;
<span class="lnr">567 </span>    <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">=</span> &quot;&quot;;
<span class="lnr">568 </span>    <span class="Statement">for</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">i</span> <span class="Operator">=</span> <span class="Constant">1</span>; <span class="Operator">$</span><span class="Identifier">i</span> <span class="Statement">&lt;=</span> <span class="Operator">$</span><span class="Identifier">numlines</span>; <span class="Operator">$</span><span class="Identifier">i</span><span class="Operator">++</span><span class="Special">)</span>
<span class="lnr">569 </span>    <span class="Special">{</span>
<span class="lnr">570 </span>        <span class="Type">list</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">randnum</span>, <span class="Operator">$</span><span class="Identifier">sourcehex</span>, <span class="Operator">$</span><span class="Identifier">linepreview</span><span class="Special">)</span> <span class="Operator">=</span> GetRandomFileLine<span class="Special">(</span><span class="Operator">$</span><span class="Identifier">path</span>, <span class="Operator">$</span><span class="Identifier">exclude</span><span class="Special">)</span>;
<span class="lnr">571 </span>        <span class="Statement">if</span><span class="Special">(</span><span class="Operator">$</span><span class="Identifier">noLineRepeat</span><span class="Special">)</span>
<span class="lnr">572 </span>            <span class="Operator">$</span><span class="Identifier">exclude</span><span class="Special">[]</span> <span class="Operator">=</span> <span class="Operator">$</span><span class="Identifier">randnum</span>;
<span class="lnr">573 </span>        <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> &quot;<span class="String">FILE1 RANDOM LINE </span><span class="Operator">$</span><span class="Identifier">i</span><span class="String">:</span><span class="Special">\n</span>&quot;;
<span class="lnr">574 </span>        <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> &quot;<span class="String">RANDOM LINE NUMBER (FILE1): </span><span class="Operator">$</span><span class="Identifier">randnum</span><span class="Special">\n</span>&quot;;
<span class="lnr">575 </span>        <span class="Operator">$</span><span class="Identifier">printout</span> <span class="Operator">.=</span> &quot;<span class="String">LINE PREVIEW: </span><span class="Operator">$</span><span class="Identifier">linepreview</span><span class="Special">\n\n</span>&quot;;
<span class="lnr">576 </span>    <span class="Special">}</span>
<span class="lnr">577 </span>    <span class="Statement">return</span> <span class="Operator">$</span><span class="Identifier">printout</span>;
<span class="lnr">578 </span><span class="Special">}</span>
<span class="lnr">579 </span>
<span class="lnr">580 </span><span class="Special">?&gt;</span>
<span class="lnr">581 </span><span class="Function">&lt;</span><span class="Statement">form</span><span class="Function"> </span><span class="Type">action</span><span class="Function">=</span><span class="String">&quot;trustedthirdparty.htm#create&quot;</span><span class="Function"> </span><span class="Type">method</span><span class="Function">=</span><span class="String">&quot;post&quot;</span><span class="Function"> </span><span class="Type">enctype</span><span class="Function">=</span><span class="String">&quot;multipart/form-data&quot;</span><span class="Function">&gt;</span>
<span class="lnr">582 </span><span class="Function">&lt;</span><span class="Statement">table</span><span class="Function">&gt;</span>
<span class="lnr">583 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;</span>Drawing Number:<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;text&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;drawingnumber&quot;</span><span class="Function"> /&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">584 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;</span>Passcode:<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;text&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;passcode&quot;</span><span class="Function"> /&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">585 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">Drawing Info</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">586 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;</span>Name:<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;text&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;name&quot;</span><span class="Function"> /&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">587 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;</span>Description:<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">textarea</span><span class="Function"> </span><span class="Type">cols</span><span class="Function">=</span><span class="String">&quot;50&quot;</span><span class="Function"> </span><span class="Type">rows</span><span class="Function">=</span><span class="String">&quot;10&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;description&quot;</span><span class="Function">&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">textarea</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">588 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;</span>File 1 (50MB Max):<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;file&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;file1&quot;</span><span class="Function"> /&gt;</span> Choose <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;text&quot;</span><span class="Function"> </span><span class="Type">size</span><span class="Function">=</span><span class="String">&quot;2&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;randlines1&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;&quot;</span><span class="Function"> /&gt;</span> random line(s)*<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">589 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;</span>File 2 (50MB Max):<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;file&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;file2&quot;</span><span class="Function"> /&gt;</span> Choose <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;text&quot;</span><span class="Function"> </span><span class="Type">size</span><span class="Function">=</span><span class="String">&quot;2&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;randlines2&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;&quot;</span><span class="Function"> /&gt;</span> random line(s)*<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">590 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;</span>File 3 (50MB Max):<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;file&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;file3&quot;</span><span class="Function"> /&gt;</span> Choose <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;text&quot;</span><span class="Function"> </span><span class="Type">size</span><span class="Function">=</span><span class="String">&quot;2&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;randlines3&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;&quot;</span><span class="Function"> /&gt;</span> random line(s)*<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">591 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;</span><span class="Special">&amp;nbsp;</span><span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;checkbox&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;chosentwice&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;true&quot;</span><span class="Function"> /&gt;</span> Allow lines to be chosen twice<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">592 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">b</span><span class="Function">&gt;</span><span class="htmlBold">Random Numbers</span><span class="Identifier">&lt;/</span><span class="Statement">b</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">593 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;</span>Number Range:<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;</span>From <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;text&quot;</span><span class="Function"> </span><span class="Type">size</span><span class="Function">=</span><span class="String">&quot;9&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;lowval&quot;</span><span class="Function"> /&gt;</span> to <span class="Function">&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;text&quot;</span><span class="Function"> </span><span class="Type">size</span><span class="Function">=</span><span class="String">&quot;9&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;highval&quot;</span><span class="Function"> /&gt;</span> (Inclusive. Range: -1000000000 to +1000000000)<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">594 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;</span>Amount of Numbers:<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;</span><span class="Function">&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;text&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;numgen&quot;</span><span class="Function"> </span><span class="Type">size</span><span class="Function">=</span><span class="String">&quot;9&quot;</span><span class="Function"> /&gt;</span> (Max: 1000)<span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">595 </span><span class="Function">&lt;</span><span class="Statement">tr</span><span class="Function">&gt;&lt;</span><span class="Statement">td</span><span class="Function">&gt;&lt;</span><span class="Statement">input</span><span class="Function"> </span><span class="Type">type</span><span class="Function">=</span><span class="String">&quot;submit&quot;</span><span class="Function"> </span><span class="Type">name</span><span class="Function">=</span><span class="String">&quot;create&quot;</span><span class="Function"> </span><span class="Type">value</span><span class="Function">=</span><span class="String">&quot;Pick the Random Numbers!&quot;</span><span class="Function"> </span><span class="Type">style</span><span class="Function">=</span><span class="String">&quot;margin-top: 10px;&quot;</span><span class="Function">/&gt;</span><span class="Identifier">&lt;/</span><span class="Statement">td</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">tr</span><span class="Identifier">&gt;</span>
<span class="lnr">596 </span><span class="Identifier">&lt;/</span><span class="Statement">table</span><span class="Identifier">&gt;</span>
<span class="lnr">597 </span><span class="Function">&lt;</span><span class="Statement">br</span><span class="Function"> /&gt;</span>
<span class="lnr">598 </span>* for random lines to be chosen, the file must be in plaintext (ASCII, .txt file) format. Maximum line length is 1000 characters.
<span class="lnr">599 </span><span class="Identifier">&lt;/</span><span class="Statement">form</span><span class="Identifier">&gt;</span>
<span class="lnr">600 </span><span class="Comment">&lt;!</span><span class="Comment">-- End Create Random Numbers --</span><span class="Comment">&gt;</span>
<span class="lnr">601 </span>
<span class="lnr">602 </span><span class="Function">&lt;</span><span class="Statement">h2</span><span class="Function">&gt;</span><span class="Title">What is TRENT?</span><span class="Identifier">&lt;/</span><span class="Statement">h2</span><span class="Identifier">&gt;</span>
<span class="lnr">603 </span>
<span class="lnr">604 </span><span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>TRENT is a <span class="Function">&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">href</span><span class="Function">=</span><span class="String">&quot;<a href="https://secure.wikimedia.org/wikipedia/en/wiki/Backronym">https://secure.wikimedia.org/wikipedia/en/wiki/Backronym</a>&quot;</span><span class="Function">&gt;</span><span class="Underlined">backronym</span><span class="Identifier">&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;</span> for <span class="Special">&amp;quot;</span><span class="Function">&lt;</span><span class="Statement">u</span><span class="Function">&gt;</span><span class="htmlUnderline">T</span><span class="Identifier">&lt;/</span><span class="Statement">u</span><span class="Identifier">&gt;</span>rusted <span class="Function">&lt;</span><span class="Statement">u</span><span class="Function">&gt;</span><span class="htmlUnderline">R</span><span class="Identifier">&lt;/</span><span class="Statement">u</span><span class="Identifier">&gt;</span>andom <span class="Function">&lt;</span><span class="Statement">u</span><span class="Function">&gt;</span><span class="htmlUnderline">Ent</span><span class="Identifier">&lt;/</span><span class="Statement">u</span><span class="Identifier">&gt;</span>ropy.<span class="Special">&amp;quot;</span> The name TRENT <span class="Function">&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">href</span><span class="Function">=</span><span class="String">&quot;<a href="https://secure.wikimedia.org/wikipedia/en/wiki/Alice_and_bob">https://secure.wikimedia.org/wikipedia/en/wiki/Alice_and_bob</a>&quot;</span><span class="Function">&gt;</span><span class="Underlined">comes from cryptography</span><span class="Identifier">&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;</span>, where he is normally used to represent a mutually trusted third party. That's exactly what our TRENT service is: a third party random number generator for drawings, contests, and lotteries. TRENT allows both the drawing organizer and contestants to be sure that the winner was selected randomly, and that the random numbers were not biased in any way.<span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">605 </span>
<span class="lnr">606 </span><span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>To understand how TRENT works, we must understand the problem that TRENT solves. Suppose a person named Chuck runs a website and wants to host a drawing between the users of his website. The lucky winner of the drawing will get a prize of $100. Chuck could pick a random user himself; he could even use <span class="Function">&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">href</span><span class="Function">=</span><span class="String">&quot;<a href="https://secure.wikimedia.org/wikipedia/en/wiki/Radioactive_decay">https://secure.wikimedia.org/wikipedia/en/wiki/Radioactive_decay</a>&quot;</span><span class="Function">&gt;</span><span class="Underlined">radioactive decay</span><span class="Identifier">&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;</span> as a source of randomness to ensure the drawing is absolutely fair. That would be great, but Chuck has no way of proving to his users that he actually did that instead of picking a friend (or even himself) and saying it was a random choice.<span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">607 </span>
<span class="lnr">608 </span><span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>Chuck must be able to generate a random number and prove the following points to his users:<span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">609 </span>
<span class="lnr">610 </span><span class="Function">&lt;</span><span class="Statement">ul</span><span class="Function">&gt;</span>
<span class="lnr">611 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>The number is actually random and wasn't biased towards a certain set of values.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">612 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>Chuck didn't repeat the random number selection over and over until he got the number he wanted.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">613 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>Everyone was given an equal chance of winning (when the random number is used for a drawing).<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">614 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>Chuck didn't change the meaning of the random number after it had been selected.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">615 </span><span class="Identifier">&lt;/</span><span class="Statement">ul</span><span class="Identifier">&gt;</span>
<span class="lnr">616 </span>
<span class="lnr">617 </span><span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>TRENT provides a means for Chuck to prove those points. TRENT solves the problem with the following security measures.<span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">618 </span>
<span class="lnr">619 </span><span class="Function">&lt;</span><span class="Statement">ul</span><span class="Function">&gt;</span>
<span class="lnr">620 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>TRENT uses <span class="Function">&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">href</span><span class="Function">=</span><span class="String">&quot;<a href="https://secure.wikimedia.org/wikipedia/en/wiki//dev/urandom">https://secure.wikimedia.org/wikipedia/en/wiki//dev/urandom</a>&quot;</span><span class="Function">&gt;</span><span class="Underlined">/dev/urandom</span><span class="Identifier">&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;</span>, the ultra-secure cryptographic random number generator built into Linux.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">621 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>TRENT does not allow Chuck to bias the numbers in any way.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">622 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>TRENT enforces at least a 24-hour period between when a drawing number is reserved and when the actual drawing takes place. This allows Chuck to publish the drawing number ahead of time to prove he isn't repeating the drawing until he gets the results he wants.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">623 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>TRENT accepts up to 3 texts files which can be used by Chuck to prove that the user list wasn't altered after the random numbers were selected. TRENT saves the SHA256 checksum of the file, so the <span class="Function">&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">href</span><span class="Function">=</span><span class="String">&quot;/checksums.htm&quot;</span><span class="Function">&gt;</span><span class="Underlined">checksum calculator</span><span class="Identifier">&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;</span> can be used to ensure the file Chuck provides to his users is the same as the one Chuck provided to TRENT.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">624 </span><span class="Identifier">&lt;/</span><span class="Statement">ul</span><span class="Identifier">&gt;</span>
<span class="lnr">625 </span>
<span class="lnr">626 </span><span class="Function">&lt;</span><span class="Statement">h3</span><span class="Function">&gt;</span><span class="Title">How to Use TRENT for Your Drawings</span><span class="Identifier">&lt;/</span><span class="Statement">h3</span><span class="Identifier">&gt;</span>
<span class="lnr">627 </span><span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>To use TRENT for your drawings, lotteries, and contests, all you have to do is follow a few simple steps:<span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">628 </span>
<span class="lnr">629 </span><span class="Function">&lt;</span><span class="Statement">ol</span><span class="Function">&gt;</span>
<span class="lnr">630 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>Reserve a drawing number.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">631 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>Give the drawing number to your clients. Provide at least 24 hours to allow them to check that the drawing number has been reserved.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">632 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>Tell TRENT what kind of random numbers you want and let TRENT pick them.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">633 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>Give your users the link to TRENT's drawing results page so everyone can verify that the drawing was fair.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">634 </span><span class="Identifier">&lt;/</span><span class="Statement">ol</span><span class="Identifier">&gt;</span>
<span class="lnr">635 </span>
<span class="lnr">636 </span><span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>There are a few important things you have to do to make sure your users can trust the results:<span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">637 </span>
<span class="lnr">638 </span><span class="Function">&lt;</span><span class="Statement">ul</span><span class="Function">&gt;</span>
<span class="lnr">639 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>In the description field, provide an easy method to determine the winner from the random numbers.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">640 </span>    <span class="Function">&lt;</span><span class="Statement">li</span><span class="Function">&gt;</span>If the outcome of the drawing depends on some extra data, such as a user list, save it as a plaintext (.txt) file and give it to TRENT. Even if you don't want to pick a random line in the file, giving the extra data to TRENT allows your clients to verify that the data hasn't been altered <span class="Function">&lt;</span><span class="Statement">em</span><span class="Function">&gt;</span><span class="htmlItalic">after</span><span class="Identifier">&lt;/</span><span class="Statement">em</span><span class="Identifier">&gt;</span> the drawing has taken place.<span class="Identifier">&lt;/</span><span class="Statement">li</span><span class="Identifier">&gt;</span>
<span class="lnr">641 </span><span class="Identifier">&lt;/</span><span class="Statement">ul</span><span class="Identifier">&gt;</span>
<span class="lnr">642 </span>
<span class="lnr">643 </span><span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>That's all you have to do! TRENT will take care of explaining to your clients how to make sure the drawing was fair. Feel free to run a few practice drawings to get a feel for how TRENT works.<span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">644 </span>
<span class="lnr">645 </span><span class="Function">&lt;</span><span class="Statement">h2</span><span class="Function">&gt;</span><span class="Title">Source Code</span><span class="Identifier">&lt;/</span><span class="Statement">h2</span><span class="Identifier">&gt;</span>
<span class="lnr">646 </span>
<span class="lnr">647 </span><span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;</span>TRENT's source code is available for peer review. Please note that the code is provided for peer review purposes only. Please do not copy it, distribute it, or alter it in any way. I really would like to make TRENT Free Software but I can't because I know that if I did, backdoored/insecure versions of TRENT would be created. But if you would like to use TRENT's code for a specific purpose, <span class="Function">&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">href</span><span class="Function">=</span><span class="String">&quot;/contact.htm&quot;</span><span class="Function">&gt;</span><span class="Underlined">ask me</span><span class="Identifier">&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;</span>, and I'll probably let you. Thanks for understanding.<span class="Identifier">&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">648 </span>
<span class="lnr">649 </span><span class="Function">&lt;</span><span class="Statement">p</span><span class="Function">&gt;&lt;</span><span class="Statement">a</span><span class="Function"> </span><span class="Type">href</span><span class="Function">=</span><span class="String">&quot;/source/trent.html&quot;</span><span class="Function">&gt;&lt;</span><span class="Statement">strong</span><span class="Function">&gt;</span><span class="Underlined">See TRENT's Source Code</span><span class="Identifier">&lt;/</span><span class="Statement">strong</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">a</span><span class="Identifier">&gt;&lt;/</span><span class="Statement">p</span><span class="Identifier">&gt;</span>
<span class="lnr">650 </span>
<span class="lnr">651 </span>
</pre>
</body>
</html>
