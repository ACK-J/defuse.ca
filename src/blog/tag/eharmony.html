<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>The Code Files - eharmony</title>
        <link rel="stylesheet" href="/blog/theme/css/main.css" />
        <link href="/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="The Code Files Atom Feed" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/blog/">The Code Files </a></h1>
                <nav><ul>
                    <li><a href="/blog/category/life.html">life</a></li>
                    <li><a href="/blog/category/linux.html">linux</a></li>
                    <li><a href="/blog/category/math.html">math</a></li>
                    <li><a href="/blog/category/programming.html">programming</a></li>
                    <li><a href="/blog/category/security.html">security</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/blog/cracking-eharmonys-unsalted-hashes-with-crackstation.html">Cracking eHarmony's Unsalted Hashes with CrackStation</a></h1>
<footer class="post-info">
        <abbr class="published" title="2012-06-09T00:00:00">
                Sat 09 June 2012
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/blog/author/taylor-hornby.html">Taylor Hornby</a>
        </address>
<p>In <a href="/blog/category/security.html">security</a>. </p>
<p>tags: <a href="/blog/tag/passwords.html">passwords</a><a href="/blog/tag/hashing.html">hashing</a><a href="/blog/tag/eharmony.html">eharmony</a></p>
</footer><!-- /.post-info --><p>This week, LinkedIn, eHarmony, and last.fm have all confirmed that their
password hash databases have been breached. In all three cases, passwords were
stored as an unsalted hash. I've already reported the <a class="reference external" href="https://defuse.ca/blog/2012/06/cracking-linkedin-hashes-with-crackstation/">results of cracking
LinkedIn's password hashes with CrackStation</a>, now it's eHarmony's turn.</p>
<p>eHarmony stored their users' passwords as an unsalted md5 hash. The leaked file
contains 1,516,877 hashes. You can download the original file from one of either
of the following links:</p>
<ul class="simple">
<li><a class="reference external" href="https://defuse.ca/files/eharmony-hashes.txt">eHarmony Hashes HTTP Mirror</a>.</li>
<li><a class="reference external" href="http://thepiratebay.se/torrent/7341755/eHarmony_Unsalted_MD5_Hash_Database">eHarmony Hashes TORRENT Mirror</a>.</li>
</ul>
<p>There are no repeated hashes in the file, so presumably the party that leaked
them removed the duplicates. Because there are no duplicates, I can't provide
any &quot;most common passwords&quot; statistics, but I can report how many
<a class="reference external" href="https://crackstation.net/">CrackStation</a> was able to crack, and how fast it did so.</p>
<p>The cracking process took 23.47 hours and recovered 275,860 (18.2%) of the
passwords. CrackStation processed the hashes at an average rate of 17.94 hashes
per second. All passwords are upper case, so I suspect that eHarmony was
converting passwords to upper case before hashing them to implement case
insensitivity (another big no-no).</p>
<p>CrackStation uses two dictionaries. One, which I call the &quot;medium&quot; dictionary,
has 1,493,677,782 entries. The other, which I call the &quot;huge&quot; dictionary, has
15,171,326,912 entries. 250,122 of the cracked passwords are present in the
&quot;medium&quot; dictionary, 97,419 are in the &quot;huge&quot; dictionary, and 71,380 passwords
are in both.</p>
<p>If eHarmony had <a class="reference external" href="https://crackstation.net/hashing-security.htm">used salt in their hashes</a> like they should have been,
I wouldn't have been able to run this attack. In fact, salting would have forced
me to run a dictionary attack on each hash by itself, and that would have taken
me over 31 years.</p>
<p>I'm very glad the LinkedIn, eHarmony, and last.fm breaches all went public at
nearly the same time. The stories are have been covered by nearly every tech
news website, and the issue of inadequate server-side password protection is
finally being addressed. I hope other companies will learn from these breaches
and start using salted hashes if they aren't already doing so.</p>
<p>Unsalted hashes are bad, but storing passwords in plain-text is even worse.
Visit my <a class="reference external" href="https://defuse.ca/password-policy-hall-of-shame.htm">Password Policy Hall of Shame</a> for a list of websites that are
probably storing your password in the clear.</p>
<p>You probably came here wanting to see passwords, so I won't disappoint. Here's
a random sample:</p>
<pre class="code text literal-block">
39007e310acd5cc5582c34c408ebf4cc :: RAWANN
c69f24b431852eb5b2db419860387dad :: SHELDURAY88
713f6fcbeeacbd3a78401382f88f5d1f :: KJ1017
86fc184cabcf0626c479927cc4e5e998 :: PUSSY310
c075be959b6831fb01d52591963d12b7 :: KARAAGE4
6c058fea843d5bff058c939fde3a6eb8 :: TH3EMPRESS
2dfecece2bf00698dd5fbae90e2f0860 :: ELLEGRA
e720578393bb68956f079c3db426d6ec :: 81PIRTER73
b0963f1a7fd94698a6e76e402daffcef :: KORRESHI
026d29ad37c6c672315e5a9c358d0a7c :: CLC47
7d01d8893e7ddbb18ceb40c59ef384c2 :: ROMELP
bf1a688689f82ba39b9efa236d09c539 :: OFTROY
dfcd9ad16c5358c1c420343a7b2b683b :: MVN2006
14f6609d95e3830b14709bce165041af :: MIKYONE
2b1841891df6de05b163d8dbbe79036c :: JAMFILE
9fe44d8eb7fbc5217fad2e54d09871ed :: TRIATA
961887ee6a084c02619f22f6b2e8a852 :: IAMTHATIS
fd9d9fa433c0d9385345355c17be13f4 :: PEACHKA1
fa22376fe0782fe9313385846e66b979 :: JAHAAD
095614e5971ad8a81d4f232c00bbf33d :: SARAHMIA1
f14c92dd1b2281cdf0f5999e595442de :: LEBIN
6e0f9ff4606b41705ea25bcbff1ac94b :: WINGK2
49cacc76a288058b68ded69f0c804269 :: CHARLIEXX
cbc7f37615111efe8e246d3316e24408 :: MB1229
81fc99cc34d28eec3c90109cab7ddfbe :: EMETI
e838f7db8ef56faa9b49e8215dfbbee7 :: KITABLAR
02ae65a2f3dac98a54290f09c39758ed :: JENGARY
3a7edcb86afee6b0853fba0a16672bcd :: GODSPELL2
22d541659b917e40146f4d4256b2a2e2 :: LETSTALK2
4e953e9a0a0f2503e8b8269b2c4a8057 :: 1MEMO1
</pre>
                </article>
            </aside><!-- /#featured -->
            </ol><!-- /#posts-list -->
            </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://twitter.com/DefuseSec">twitter</a></li>
                            <li><a href="https://github.com/defuse">github</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>